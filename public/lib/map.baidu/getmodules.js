_jsload&&_jsload('opmb', 'BMap.register(function(e){e.config.doubleTouchInterval=500;var aZ=false,aU,a1=false,aY=false,i;var aW=function(a7,a6){var a5=new aw(a7);var a8=a6.target;var a3=null;var a4=null;while(a8&&a8!=e.container){if(a8.hashCode){var a2=l.I(a8.hashCode);if(a2 instanceof aF&&a8.nodeName.toLowerCase()!="canvas"){a3=a2}if(a2 instanceof ay){a4=a2}}a8=a8.offsetParent}a5.offsetX=a6.changedTouches[0].clientX;a5.offsetY=a6.changedTouches[0].clientY;a5.pixel=new aK(a5.offsetX,a5.offsetY);a5.point=e.pixelToPoint(a5.pixel);a5.overlay=a3;a5.infoWindow=a4;return a5};var a0=function(a2){aZ=true;i=new aw("ontouch").inherit(a2);aU=new aK(a2.changedTouches[0].clientX,a2.changedTouches[0].clientY);var a3=aW("onclickex",a2);setTimeout(function(){aX();e.dispatchEvent(a3)},e.config.doubleTouchInterval);e.dispatchEvent(aW("onclick",a2))};var aX=function(){if(aZ){aZ=false;aU=null;if(!a1){e.dispatchEvent(i)}}};var aV=function(a2){a1=true};var aT=function(){a1=false};l.on(e.platform,"touchstart",function(a2){a2.preventDefault();aY=false;e.dispatchEvent(aW("ontouchstart",a2).inherit(a2));return false});l.on(e.platform,"touchmove",function(a2){a2.preventDefault();aY=true;e.dispatchEvent(aW("ontouchmove",a2).inherit(a2))});l.on(e.platform,"touchend",function(a3){a3.preventDefault();if(!aY){if(aZ){aV(a3);e.dispatchEvent(aW("onclick",a3));var a4=new aK(a3.changedTouches[0].clientX,a3.changedTouches[0].clientY);var a2=v(aU,a4);if(a2<20){e.dispatchEvent(aW("ondblclick",a3));e.dispatchEvent(new aw("ondbltouch").inherit(a3))}else{e.dispatchEvent(aW("ontouchend",a3).inherit(a3))}aX();aT()}else{a0(a3)}}e.dispatchEvent(new aw("ontouchend").inherit(a3))});l.on(e.platform,"gesturestart",function(a2){a2.preventDefault();e.dispatchEvent(new aw("ongesturestart").inherit(a2))});l.on(e.platform,"gesturechange",function(a2){a2.preventDefault();e.dispatchEvent(new aw("ongesturechange").inherit(a2))});l.on(e.platform,"gestureend",function(a2){a2.preventDefault();e.dispatchEvent(new aw("ongestureend").inherit(a2))})});BMap.register(function(e){e.config.enablePinchToZoom=true;e.config.enablePinchToRotate=false;var aW={x:0,y:0,scale:1,rotation:0};var a2=[{x:0,y:0},{x:0,y:0}];var aZ=0,aX=0,a0=false,i=false;var aY=function(a5,a4){var a3=new aw(a5);a3.offsetX=a4.changedTouches[0].clientX;a3.offsetY=a4.changedTouches[0].clientY;a3.pixel=new aK(a3.offsetX,a3.offsetY);a3.point=e.pixelToPoint(a3.pixel);return a3};var a1=e.platform.style;var aT=function(){if(e.config.enableDragging){a1.WebkitTransformOrigin=((a2[0].x+a2[1].x)/2-e.offsetX)+"px "+((a2[0].y+a2[1].y)/2-e.offsetY)+"px"}else{a1.WebkitTransformOrigin=e.width/2+"px "+e.height/2+"px"}};var aU=function(){a1.WebkitTransform=(e.config.enableDragging?"translate("+aW.x+"px, "+aW.y+"px) ":"")+(e.config.enablePinchToZoom?"scale("+aW.scale+") ":"")+(e.config.enablePinchToRotate?"rotate("+aW.rotation+"deg)":"")};var aV=function(a3){if(a3){a1.WebkitTransform=""}aW.x=0;aW.y=0;aW.scale=1;aW.rotation=0};e.addEventListener("touchstart",function(a6){if(a6.overlay&&a6.overlay.toString()=="Marker"){return}var a3=a6.targetTouches.length;aZ=a3;var a5=e.temp;if(a5.dragAni){a5.dragAni.stop();a5.dragAni=null}if(a3<=2){for(var a4=0;a4<a3;a4++){a2[a4].x=a6.targetTouches[a4].clientX;a2[a4].y=a6.targetTouches[a4].clientY}}if(a3==2){aT()}else{if(a3==1){this.temp._startX=aW.x;this.temp._startY=aW.y}}});e.addEventListener("touchmove",function(a6){if(aZ==1&&aX!=2||aZ==2){for(var a5=0;a5<aZ;a5++){aW.x+=(a6.targetTouches[a5].clientX-a2[a5].x)/aZ;aW.y+=(a6.targetTouches[a5].clientY-a2[a5].y)/aZ;a2[a5].x=a6.targetTouches[a5].clientX;a2[a5].y=a6.targetTouches[a5].clientY}aU()}if(aZ==1&&aX==2){var a4=new aK(a6.targetTouches[0].clientX,a6.targetTouches[0].clientY);if(v(a4,new aK(a2[0].x,a2[0].y))<v(a4,new aK(a2[1].x,a2[1].y))){aW.x+=(a4.x-a2[0].x);aW.y+=(a4.y-a2[0].y);a2[0].x=a4.x;a2[0].y=a4.y}else{aW.x+=(a4.x-a2[1].x);aW.y+=(a4.y-a2[1].y);a2[1].x=a4.x;a2[1].y=a4.y}aU()}if(aZ==1&&this.config.enableDragging){var a3=e.temp;if(!a3._moved){a3._moved=true;var a7=aY("ondragstart",a6);e.dispatchEvent(a7);e.dispatchEvent(new aw("onmovestart"));a3.dragStartPos=a7.pixel;a3.dragStartTime=new Date().getTime();a0=true}a3.lastDomMoveTime=new Date().getTime();e.dispatchEvent(new aw("ondragging"))}});e.addEventListener("touchend",function(a8){aX=aZ;aZ=a8.targetTouches.length;if(l.Platform.android){aZ=0}if(aZ==0){if(i){var ba=Math.round(Math.log(aW.scale)/Math.log(2)),a5=e.pointToPixel(e.getCenter()),a4=new aK((a5.x-aW.x/Math.pow(2,ba)),(a5.y-aW.y/Math.pow(2,ba))),a3=e.config.enableDragging?e.pixelToPoint(a4):e.getCenter(),a9=e.config.enablePinchToZoom?Math.max(Math.min(e.zoomLevel+ba,e.config.zoomLevelMax),e.config.zoomLevelMin):e.getZoom();e.centerAndZoom(a3,a9)}var a6=aW.x!=this.temp._startX||aW.y!=this.temp._startY;if(a6){if(a0&&!i){var a7=aY("ondragend",a8);this.dispatchEvent(a7);e._processInertialDraggingForTouch(a7.pixel,{x:aW.x,y:aW.y});a0=false}if(i){aV(true)}else{aV(false)}}e.temp._moved=false;aV();i=false;aX=0}});e.addEventListener("gesturechange",function(a3){aW.scale=a3.scale;aW.rotation=a3.rotation;i=true;aU()})});C.prototype._processInertialDraggingForTouch=function(bb,aU){var bd=this,e=bd.platform.style;if(!bd.config.enableInertialDragging){e.WebkitTransform="";bd._setPlatformPosition(bd.offsetX+aU.x,bd.offsetY+aU.y);bd.dispatchEvent(new aw("onmoveend"));return}var a2=bd.temp;var aT=new Date().getTime();if(aT-a2.lastDomMoveTime>140){e.WebkitTransform="";bd._setPlatformPosition(bd.offsetX+aU.x,bd.offsetY+aU.y);bd.dispatchEvent(new aw("onmoveend"));a2._moved=false;return}else{var bc=a2.dragStartPos,a6=bb,i=v(bc,a6),a9=[a6.x-bc.x>0?1:-1,a6.y-bc.y>0?1:-1],aW=(aT-a2.dragStartTime)/1000,a0=i/aW/2,a1=0.5,ba=a0/(2*a1),a8=0.5*ba*a0/1000,aZ=Math.abs(bc.x-a6.x),aY=Math.abs(bc.y-a6.y),a5=0,a3=0;if(aY==0){a5=aZ}else{var aX=Math.abs(bc.x-a6.x)/Math.abs(bc.y-a6.y);a3=Math.round(Math.sqrt(a8*a8/(1+aX*aX)));a5=Math.round(aX*a3)}if(a9[0]==-1){a5=-a5}if(a9[1]==-1){a3=-a3}if(a2.dragAni){a2.dragAni.stop();a2.dragAni=null;bd.dispatchEvent(new aw("onmoveend"))}var aV=a0/1000,a7=bd.offsetX,a4=bd.offsetY;a2.dragAni=new aG({duration:ba,fps:25,transition:function(be){var be=be*aV/(2*a1);return aV*be-a1*be*be},render:function(be){be=be*(4*a1)/(aV*aV);e.WebkitTransform="translate("+(aU.x+Math.round(be*a5))+"px ,"+(aU.y+Math.round(be*a3))+"px)"},finish:function(){a2.dragAni=null;e.WebkitTransform="";bd._setPlatformPosition(a7+aU.x+Math.round(a5),a4+aU.y+Math.round(a3));bd.dispatchEvent(new aw("onmoveend"))}})}};var ab=C.prototype;ab.enablePinchToZoom=function(){this.config.enablePinchToZoom=true};ab.disablePinchToZoom=function(){this.config.enablePinchToZoom=false};ab.enablePinchToRotate=function(){this.config.enablePinchToRotate=true};ab.disablePinchToRotate=function(){this.config.enablePinchToRotate=false};aE.prototype.zoom=function(aV,aU){var aX=aU?aU.width:0;var aW=aU?aU.height:0;var a8=this.map;var ba=a8.config;var a9=this;if(!a9.tilesDiv){return}var a7={x:aV.x-parseInt(a9.tilesDiv.style.left)-a8.offsetX,y:aV.y-parseInt(a9.tilesDiv.style.top)-a8.offsetY};if(a8.overlayDiv){l.hide(a8.overlayDiv)}var e;for(var a4=0,a3=a9.tileLayers.length;a4<a3;a4++){e=a9.tileLayers[a4];if(!e.baseLayer){e.tilesDiv.style.visibility="hidden"}}if(!this.zoomsDiv){this.zoomsDiv=this.tilesDiv.cloneNode(true)}else{if(this.zoomsDiv.parentNode&&!this._zTimeLine){this.zoomsDiv.parentNode.removeChild(this.zoomsDiv);this.zoomsDiv=null;this.zoomsDiv=this.tilesDiv.cloneNode(true)}}var aT=this.zoomsDiv,a1=aT.style;a1.display="block";this.tilesDiv.style.visibility="hidden";a8.platform.insertBefore(aT,a8.platform.firstChild);var a6=[];var aY=a8.zoomLevel-a8.lastLevel;if(!a9._diff){a9._diff=aY}else{if(a8.zoomLevel-a8.lastLevel>0){a9._diff++}else{a9._diff--}}if(this._zTimeLine&&this._zTimeLine.schedule==0){this._zTimeLine.stop();this._zTimeLine=null;aY=a9._diff}if((!aU||aU.width==0&&aU.height==0)&&ba.enableContinuousZoom){a8.temp.zoomer.action(aV,aY>0?true:false)}var a0=Math.pow(2,aY);var a5=aT.children.length;for(var a4=a5-1;a4>-1;a4--){var aZ={};var a2=aT.children[a4].style;aZ.top=parseInt(a2.top)||0;aZ.left=parseInt(a2.left)||0;aZ.width=parseInt(a2.width);aZ.height=parseInt(a2.height);aZ.dw=aZ.width*a0-aZ.width;aZ.dh=aZ.height*a0-aZ.height;aZ.dx=(aZ.left-a7.x)*a0-(aZ.left-a7.x);aZ.dy=(aZ.top-a7.y)*a0-(aZ.top-a7.y);a6[a4]=aZ}aT._ol=parseInt(aT.style.left);aT._ot=parseInt(aT.style.top);if(this._zTimeLine){this._zTimeLine.stop();this._zTimeLine=null}this._zTimeLine=new aG({fps:20,duration:ba.enableContinuousZoom?ba.zoomerDuration:1,transition:k.easeInQuad,render:function(bd){if(bd<0.1){return}for(var bc=a6.length-1;bc>-1;bc--){var be=a6[bc];if(aT.children[bc]){var bb=aT.children[bc].style;bb.top=Math.round(be.top+be.dy*bd)+"px";bb.left=Math.round(be.left+be.dx*bd)+"px";bb.width=Math.ceil(be.width+be.dw*bd)+"px";bb.height=Math.ceil(be.height+be.dh*bd)+"px"}}if(aX||aW){a1.left=aT._ol-(aX*bd)+"px";a1.top=aT._ot-(aW*bd)+"px"}},finish:function(){a9.moveGridTiles(true);if(a8.overlayDiv){if(l.Browser.ie&&l.Browser.ie<8||document.compatMode=="BackCompat"){l.show(a8.overlayDiv)}else{setTimeout(function(){l.show(a8.overlayDiv)},100)}}for(var bc=0,bb=a9.tileLayers.length;bc<bb;bc++){e=a9.tileLayers[bc];if(!e.baseLayer){e.tilesDiv.style.visibility=""}}a9.tilesDiv.style.visibility="";delete a9._diff;a8.dispatchEvent(new aw("onzoomend"));aT=null;a9._zTimeLine=null}})};');
﻿_jsload&&_jsload('control', 'l.extend(K.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){P.prototype.initialize.call(this,e);this._render();this._updateState();this._bind(e);return this._container},_bind:function(i){var e=this;i.addEventListener("load",function(aT){e._updateState()});i.addEventListener("moveend",function(aT){e._updateState()});i.addEventListener("zoomend",function(aT){e._updateState()})},_render:function(){P.prototype._render.call(this);l.ac(this._container,"BMap_cpyCtrl");this._container.style.cursor="default";this._container.style.whiteSpace="nowrap";this._container.style.MozUserSelect="none";P.prototype._setPosition.call(this)},_updateState:function(){if(!this._map||!this._container||this._copyrightCollection.length==0){return}for(var aW=0,aU=this._copyrightCollection.length;aW<aU;aW++){var aT;var e=this._map.getZoom();if(this._copyrightCollection[aW].mapType!=""&&this._map.mapType!=this._copyrightCollection[aW].mapType){aT=false}else{if(e<this._copyrightCollection[aW].minZoom){aT=false}else{var a0=this._map.pixelToPoint({x:0,y:0});var aZ=this._map.pixelToPoint({x:this._map.width,y:this._map.height});var aY=new y(a0.lng,a0.lat,aZ.lng,aZ.lat);if(this._copyrightCollection[aW].bounds&&aY.intersects(this._copyrightCollection[aW].bounds)==null){aT=false}else{aT=true}}}if(aT){if(this._container){var a1=false;for(var aV=0,aX=this._container.children.length;aV<aX;aV++){if(this._container.children[aV].getAttribute("_cid")==this._copyrightCollection[aW].id){a1=true;this._container.children[aV].style.display="inline";if(this._container.children[aV].innerHTML!=this._copyrightCollection[aW].content){this._container.children[aV].innerHTML=this._copyrightCollection[aW].content}break}}if(!a1){this._generateHTML(this._copyrightCollection[aW])}}}else{if(this._container){for(var aV=0;aV<this._container.children.length;aV++){if(this._container.children[aV].getAttribute("_cid")==this._copyrightCollection[aW].id&&this._container.children[aV].style.display!="none"){this._container.children[aV].style.display="none";return}}}}}},addCopyright:function(aU){if(!aU||typeof aU.id!="number"||isNaN(aU.id)){return}var e={minZoom:0,bounds:null,content:"",mapType:""};for(var aT in aU){e[aT]=aU[aT]}if(this._map){var aX=e.minZoom;if(aX==-1||aX<aJ[this._map.mapType].zoomLevelMin||aX>aJ[this._map.mapType].zoomLevelMax){e.minZoom=aJ[this._map.mapType].zoomLevelMin}if(e.mapType!=""&&!aJ[e.mapType]){e.mapType=BMAP_NORMAL_MAP}}var aV=this.getCopyright(aU.id);if(aV){for(var aW in e){aV[aW]=e[aW]}}else{this._copyrightCollection.push(e)}this._updateState()},getCopyright:function(aU){for(var aT=0,e=this._copyrightCollection.length;aT<e;aT++){if(this._copyrightCollection[aT].id==aU){return this._copyrightCollection[aT]}}},getCopyrightCollection:function(){return this._copyrightCollection},removeCopyright:function(aW){var aU;for(var aT=0,e=this._copyrightCollection.length;aT<e;aT++){if(this._copyrightCollection[aT].id==aW){aU=this._copyrightCollection.splice(aT,1);aT--;e=this._copyrightCollection.length}}var aV=this.getDom(aW);if(aV&&aV.parentNode){aV.parentNode.removeChild(aV);aV=null}this._updateState();return aU},_generateHTML:function(e){if(!this._container){return}this._container.innerHTML+="<span style=\'-webkit-text-size-adjust:none;color:#000;background:none;line-height:15px;font:11px arial,simsun\' _cid=\'"+e.id+"\'>"+e.content+"</span>"},getDom:function(aV){var aU=P.prototype.getDom.call(this);if(typeof aV=="undefined"){return aU}else{if(aU){for(var aT=0,e=aU.children.length;aT<e;aT++){if(aU.children[aT].getAttribute("_cid")==aV){return aU.children[aT]}}}}}});l.extend(ah.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){P.prototype.initialize.call(this,e);this._initParam();this._render();this._bind();this._initOverviewMap();l.on(this._container,"click",ag);l.on(this._container,"dblclick",ag);l.on(this._container,"mousewheel",ag);l.on(this._container,"mouseup",function(i){i=window.event||i;if(i.button==2){ag(i)}});if(window.addEventListener){this._container.addEventListener("DOMMouseScroll",function(i){ag(i)},true)}return this._container},_initParam:function(){if(this._init){return}this._init=true;this._omCanvas;this._omMapContainer;this._omView;this._omViewMv;this._omBtn;this._borderWidth=1;this._btnWidth=15;this._btnHeight=15;this._quad=4;this._overviewMap=null;this._minZoomLevel=-1;this._maxZoomLevel=-1;this._curOMZoomLevel=-1;this._wRatio=1;this._hRatio=1;this._temp={};this._currentOp="";this._overviewInitialized=false},_getCurOMZoomLevel:function(){if(!this._map){return}var e=this._map.getZoom();var i=e-this._opts.zoomInterval;if(i<this._minZoomLevel){return this._minZoomLevel}else{if(i>this._maxZoomLevel){return this._maxZoomLevel}else{return i}}return -1},_render:function(){P.prototype._render.call(this);var e=l.Browser.ie!=false?" BMap_ie"+l.Browser.ie:"";var i=this._container;i.innerHTML=this._generateHTML();l.ac(i,"BMap_omCtrl"+e);this._omCanvas=i.children[0].children[0];this._omMapContainer=this._omCanvas.children[0];this._omViewMv=this._omCanvas.children[1];this._omViewMvInn=this._omViewMv.children[0];this._omBtn=i.children[1];this.setSize(this._opts.size);this._omViewMv.style.cursor=aQ.defaultCursor},_generateHTML:function(){var e=[\'<div class="BMap_omOutFrame"><div class="BMap_omInnFrame">\',\'<div class="BMap_omMapContainer"></div>\',\'<div class="BMap_omViewMv"><div class="BMap_omViewInnFrame"><div></div></div></div>\',\'</div></div><div class="BMap_omBtn"></div>\'];return e.join("")},_bind:function(){var e=this;l.on(this._omBtn,"click",function(){e.changeView()});if(l.Browser.ie){l.on(this._omBtn,"dblclick",function(){e.changeView()})}l.on(this._omViewMv,"mousedown",function(i){if(e._omViewMv&&typeof e._omViewMv._drag!="undefined"&&e._omViewMv._drag=="true"){return}i=window.event||i;if(i.button==2){return}e._omViewMv._drag="true";var i=window.event||i;if(e._omViewMv.setCapture){e._omViewMv.setCapture()}e._bind.iniX=parseInt(an(e._omViewMv).left);e._bind.iniY=parseInt(an(e._omViewMv).top);e._bind.mx=i.pageX||i.clientX;e._bind.my=i.pageY||i.clientY;e._bind.i=0;e._bind.j=0;e._setViewMvCursor(aQ.draggingCursor);ag(i);return D(i)});l.on(document,"mousemove",function(aY){if(e._omViewMv&&e._omViewMv._drag=="true"){var aY=window.event||aY;var i=aY.pageX||aY.clientX;var aZ=aY.pageY||aY.clientY;e._bind.curX=e._bind.iniX+i-e._bind.mx;e._bind.curY=e._bind.iniY+aZ-e._bind.my;var aX=3;e._bind._moveX=0;e._bind._moveY=0;if(e._bind.curX<=0){e._bind._moveX=aX}if(e._bind.curY<=0){e._bind._moveY=aX}if(e._bind.curX+e._omViewMv.offsetWidth>=e._overviewMap.width){e._bind._moveX=-aX}if(e._bind.curY+e._omViewMv.offsetHeight>=e._overviewMap.height){e._bind._moveY=-aX}e._omViewMv.style.left=e._bind.curX+"px";e._omViewMv.style.top=e._bind.curY+"px";if((e._bind._moveX!=0||e._bind._moveY!=0)&&!e._bind.intervalId){e._bind._mapMoving=true;var aW=e._overviewMap.offsetX;var aU=e._overviewMap.offsetY;var aV=aW+e._bind._moveX;var aT=aU+e._bind._moveY;e._overviewMap._setPlatformPosition(aV,aT);e._bind.intervalId=setInterval(function(){var a1=e._bind._moveX!=0?(e._bind._moveX>0?e._bind.i+=aX:e._bind.i-=aX):e._bind.i;var a0=e._bind._moveY!=0?(e._bind._moveY>0?e._bind.j+=aX:e._bind.j-=aX):e._bind.j;e._overviewMap._setPlatformPosition(aV+a1,aT+a0)},30)}if(e._bind._moveX==0&&e._bind._moveY==0){clearInterval(e._bind.intervalId);delete e._bind.intervalId;e._bind.i=0;e._bind.j=0}ag(aY);return D(aY)}});l.on(document,"mouseup",function(aW){if(e._omViewMv&&e._omViewMv._drag=="true"){e._omViewMv._drag="";e._setViewMvCursor(aQ.defaultCursor);if(e._omViewMv.releaseCapture){e._omViewMv.releaseCapture()}if(e._bind.initX==e._bind.curX&&e._bind.initY==e._bind.curY){ag(aW);return D(aW)}e._currentOp="dragView";e._overviewMap.config.enableMouseDown=false;e._map.temp.operating=true;if(typeof e._bind.curX=="undefined"||typeof e._bind.curY=="undefined"){return}var aV=e._bind.curX+parseInt(e._omViewMv.style.width)/2+1;var aU=e._bind.curY+parseInt(e._omViewMv.style.height)/2+1;delete e._bind.curX;delete e._bind.curY;var aT=e._overviewMap.pixelToPoint({x:aV,y:aU},e._overviewMap.zoomLevel);var i=aJ[e._map.mapType].bounds;if(aT.lng<i[0]||aT.lng>i[2]||aT.lat<i[1]||aT.lat>i[3]){aT=e._overviewMap.getCenter()}e._map.temp.operating=false;if(e._bind._mapMoving==true){clearInterval(e._bind.intervalId);delete e._bind.intervalId;e._bind._mapMoving=false}e._map.temp.operating=true;setTimeout(function(){e._map.temp.operating=false;e._map.panTo(aT)},50);ag(aW);return D(aW)}})},_initOverviewMap:function(){if(this._overviewInitialized==true){return}var aT=this;var aU=aT._map;aU.addEventListener("resize",function(){if(aT._overviewMap!=null){aT._overviewMap.setCenter(aU.getCenter())}if(aT._omView!=null){aT._omView.setPoint(aU.getCenter());aT._setRatio()}aT.setAnchor(aT._opts.anchor)});if(this._opts.isOpen==false){return}if(!this._binded){aU.addEventListener("load",function(){aT._onMainZoomEnd()});aU.addEventListener("moving",function(){aT._moveView()});aU.addEventListener("moveend",function(aV){aT._onMainMoveEnd(aV)});aU.addEventListener("zoomend",function(aV){aT._onMainZoomEnd(aV)});aU.addEventListener("maptypechange",function(aV){aT._setRatio()});this._binded=true}var e=aU.getCenter();this._minZoomLevel=aJ[BMAP_NORMAL_MAP].zoomLevelMin;this._maxZoomLevel=aJ[BMAP_NORMAL_MAP].zoomLevelMax;this._curOMZoomLevel=this._getCurOMZoomLevel();this._overviewMap=new C(this._omMapContainer,{coordType:aU.config.coordType,isOverviewMap:true});this._overviewMap.disableDoubleClickZoom();this._overviewMap.centerAndZoom(e,this._curOMZoomLevel);this._omView=new aj({point:aU.getCenter(),lineStroke:1,lineColor:"#6688cc"});this._overviewMap.addOverlay(this._omView);this._omView.getDom().innerHTML=\'<div class="BMap_omViewInnFrame"><div class="BMap_omViewMask"></div></div>\';this._omViewInn=this._omView.getDom().children[0];var i=this._omView.getDom().style;i.borderLeftColor="#84b0df";i.borderTopColor="#adcff4";i.borderRightColor="#274b8b";i.borderBottomColor="#274b8b";this._setRatio();this._overviewMap.addEventListener("dragend",function(){aT._currentOp="dragMap";aU.panTo(aT._overviewMap.getCenter())});this._overviewMap.addEventListener("moveend",function(){aT._onViewMapMoveEnd()});this._overviewMap.addEventListener("mousedown",function(aV){aT._temp._downX=aV.offsetX;aT._temp._downY=aV.offsetY});this._overviewMap.addEventListener("resize",function(aV){if(aT._map&&aT._overviewMap){aT._overviewMap.setCenter(aT._map.getCenter())}aT._setRatio()});this._overviewInitialized=true},_setViewMvCursor:function(e){this._omViewMv.style.cursor=e},setAnchor:function(aV){P.prototype.setAnchor.call(this,aV);if(!this._map){return}if(l.Browser.ie){var aY=this._map.width;var aU=this._map.height;var i=this._opts.size.width;var aW=this._opts.size.height;var aT=this._opts.offset.width;var e=this._opts.offset.height;if(this._opts.isOpen==false){i=this._btnWidth;aW=this._btnHeight}var aX=this._container;switch(aV){case BMAP_ANCHOR_TOP_RIGHT:aX.style.right="auto";aX.style.left=aY-i-aT+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:aX.style.bottom="auto";aX.style.top=aU-aW-e+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:aX.style.bottom="auto";aX.style.right="auto";aX.style.top=aU-aW-e+"px";aX.style.left=aY-i-aT+"px";break;default:break}}this._setQuad();this._redraw()},changeView:function(){this.changeView._running=true;this._opts.isOpen=!this._opts.isOpen;if(!this._container){this.changeView._running=false;return}var aW=this._container;var e=this._opts.size.width;var aT=this._opts.size.height;var aV=this._btnWidth;var i=this._btnHeight;var aU=this;if(!this._opts.isOpen){this.changeView._preBtnTop=this._omBtn.style.top;this.changeView._preBtnLeft=this._omBtn.style.left;new aG({fps:25,duration:120,transition:k.easeInCubic,render:function(aX){aW.style.width=(e-Math.ceil((e-aV)*aX))+"px";aW.style.height=(aT-Math.ceil((aT-i)*aX))+"px";if(l.Browser.ie){aU._omBtn.style.top=(aU._quad==3||aU._quad==4)?parseInt(aW.style.height)-i+"px":"0";aU._omBtn.style.left=(aU._quad==1||aU._quad==4)?parseInt(aW.style.width)-aV+"px":"0";if(aU._opts.anchor>=0&&aU._opts.anchor<=BMAP_ANCHOR_BOTTOM_RIGHT){if(aU._quad==3||aU._quad==4){aW.style.top=aU._map.height-parseInt(aW.style.height)-aU._opts.offset.height+"px"}if(aU._quad==1||aU._quad==4){aW.style.left=aU._map.width-parseInt(aW.style.width)-aU._opts.offset.width+"px"}}}aU.dispatchEvent(new aw("onviewchanging"))},finish:function(){if(l.Browser.ie){aU._omBtn.style.left="0";aU._omBtn.style.top="0";if(aU._opts.anchor>=0&&aU._opts.anchor<=BMAP_ANCHOR_BOTTOM_RIGHT){if(aU._quad==3||aU._quad==4){aW.style.top=aU._map.height-aU._btnHeight-aU._opts.offset.height+"px"}if(aU._quad==1||aU._quad==4){aW.style.left=aU._map.width-aU._btnWidth-aU._opts.offset.width+"px"}}}aU._redraw();l.ac(aU._omBtn,"BMap_omBtnClosed");var aX=new aw("onviewchanged");aX.isOpen=aU._opts.isOpen;aU.dispatchEvent(aX);aU.changeView._running=false}})}else{if(this._overviewInitialized==false){this._initOverviewMap()}new aG({fps:40,duration:120,transition:k.easeOutCubic,render:function(aX){aW.style.width=(Math.ceil(e*aX))+"px";aW.style.height=(Math.ceil(aT*aX))+"px";if(l.Browser.ie){aU._omBtn.style.top=(aU._quad==3||aU._quad==4)?parseInt(aW.style.height)-i+"px":"0";aU._omBtn.style.left=(aU._quad==1||aU._quad==4)?parseInt(aW.style.width)-aV+"px":"0";if(aU._opts.anchor>=0&&aU._opts.anchor<=BMAP_ANCHOR_BOTTOM_RIGHT){if(aU._quad==3||aU._quad==4){aW.style.top=aU._map.height-parseInt(aW.style.height)-aU._opts.offset.height+"px"}if(aU._quad==1||aU._quad==4){aW.style.left=aU._map.width-parseInt(aW.style.width)-aU._opts.offset.width+"px"}}}aU.dispatchEvent(new aw("onviewchanging"))},finish:function(){if(aU._opts.anchor>=0&&aU._opts.anchor<=BMAP_ANCHOR_BOTTOM_RIGHT){if(l.Browser.ie){if(aU._quad==3||aU._quad==4){aW.style.top=aU._map.height-aT-aU._opts.offset.height+"px"}if(aU._quad==1||aU._quad==4){aW.style.left=aU._map.width-e-aU._opts.offset.width+"px"}}}aU._redraw();aU._setBtnPosition();l.rc(aU._omBtn,"BMap_omBtnClosed");var aX=new aw("onviewchanged");aX.isOpen=aU._opts.isOpen;aU.dispatchEvent(aX);aU.changeView._running=false}})}},_setRatio:function(){if(!this._map){return}var aX=this._map.zoomLevel;var aZ=this._map.pixelToPoint({x:0,y:0},aX);var aU=this._map.pixelToPoint({x:this._map.width,y:this._map.height},aX);var i=this._overviewMap.pixelToPoint({x:0,y:0},this._curOMZoomLevel);var aT=this._overviewMap.pixelToPoint({x:this._overviewMap.width,y:this._overviewMap.height},this._curOMZoomLevel);this._wRatio=(aU.lng-aZ.lng)/(aT.lng-i.lng);this._hRatio=(aU.lat-aZ.lat)/(aT.lat-i.lat);if(this._wRatio>=1||this._hRatio>=1){this._omViewMv.style.display="none";this._omView.hide()}else{var aV=parseInt(this._overviewMap.width);var e=parseInt(this._overviewMap.height);var aY=Math.round(aV*this._wRatio);var aW=Math.round(e*this._hRatio);if(this._map.mapType==BMAP_PERSPECTIVE_MAP){aW=e*0.35}this._omView.show();this._omView.setDimension(aY,aW);this._omViewMv.style.display=""}this._setOMViewMvPos()},_setOMViewMvPos:function(){if(!this._omView||!this._omView.getDom()){return}if(this._wRatio>=1||this._hRatio>=1){this._omViewMv.style.display="none";return}var i=this._omView.getDom().style;this._omViewMv.style.display="";this._omViewMv.style.width=i.width;this._omViewMv.style.height=i.height;var e=parseInt(i.width)-2;var aT=parseInt(i.height)-2;e=e<0?0:e;aT=aT<0?0:aT;this._omViewMvInn.style.width=e+"px";this._omViewMvInn.style.height=aT+"px";this._omViewInn.style.width=this._omViewMvInn.style.width;this._omViewInn.style.height=this._omViewMvInn.style.height;this._omViewMv.style.left=parseInt(i.left)+this._overviewMap.offsetX+"px";this._omViewMv.style.top=parseInt(i.top)+this._overviewMap.offsetY+"px"},setSize:function(aT){if(!aT||aT.toString()!="Size"){aT=new X(150,150)}var i=aT.width;var aU=aT.height;i=i>0?i:150;aU=aU>0?aU:150;aT.width=i;aT.height=aU;this._opts.size=aT;if(!this._container){return}if(this.changeView._running==true){var e=arguments;var aV=this;setTimeout(function(){e.callee.call(aV,aT)},120);return}aP(this._container,[i,aU]);var aV=this;setTimeout(function(){if(aV._overviewMap&&aV._map){aV._overviewMap.setCenter(aV._map.getCenter())}},100);this.setAnchor(this._opts.anchor);this.dispatchEvent(new aw("resize"))},getSize:function(){if(this._container){return new X(parseInt(this._container.style.width),parseInt(this._container.style.height))}else{return this._opts.size}},setOffset:function(e){if(!e||e.toString()!="Size"){return}P.prototype.setOffset.call(this,e);if(e.width!=0||e.height!=0){l.ac(this._container,"withOffset")}else{l.rc(this._container,"withOffset")}},_redraw:function(){if(!this._omCanvas){return}var aT=this._opts.size.width;var aW=this._opts.size.height;var aY=this._opts.padding;var e=this._borderWidth;var aU=0;var aX=0;var i=0;var aV=0;this._omCanvas.style.left=this._omCanvas.style.top=this._omCanvas.style.right=this._omCanvas.style.bottom="auto";this._omBtn.style.left=this._omBtn.style.top=this._omBtn.style.right=this._omBtn.style.bottom="auto";if(this._opts.offset.width==0&&this._opts.offset.height==0){switch(this._opts.anchor){case BMAP_ANCHOR_TOP_LEFT:this._omCanvas.style.left="0px";this._omCanvas.style.top="0px";break;case BMAP_ANCHOR_TOP_RIGHT:this._omCanvas.style.left=aY+"px";this._omCanvas.style.top="0px";break;case BMAP_ANCHOR_BOTTOM_LEFT:this._omCanvas.style.top=aY+"px";this._omCanvas.style.left="0px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:this._omCanvas.style.top=aY+"px";this._omCanvas.style.left=aY+"px";break;default:break}aU=aT-e;aX=aW-e;i=aU-aY-2*e;aV=aX-aY-2*e;if(l.Browser.ie&&document.compatMode=="BackCompat"){aU=aU+1;aX=aX+1;i=i+2;aV=aV+2}}else{this._omCanvas.style.left=this._omCanvas.style.top=this._omCanvas.style.right=this._omCanvas.style.bottom=aY+"px";aU=aT-2*e;aX=aW-2*e;i=aU-2*aY-2*e;aV=aX-2*aY-2*e;if(this._opts.offset.width!=0||this._opts.offset.height!=0){l.ac(this._container,"withOffset")}if(l.Browser.ie&&document.compatMode=="BackCompat"){aU=aU+2;aX=aX+2;i=i+2;aV=aV+2}}if(aU>0&&aX>0){aP(this._container.children[0],[aU,aX])}if(i>0&&aV>0){aP(this._omCanvas,[i,aV])}this._setBtnPosition();l.rc(this._omBtn,"BMap_omBtnClosed");if(!this._opts.isOpen){this._container.style.width=this._btnWidth+"px";this._container.style.height=this._btnHeight+"px";if(l.Browser.ie){this.changeView._preBtnTop=this._omBtn.style.top;this.changeView._preBtnLeft=this._omBtn.style.left;this._omBtn.style.left="0";this._omBtn.style.top="0"}l.ac(this._omBtn,"BMap_omBtnClosed")}},_setQuad:function(){var i=this._container;if(!i){return}var e=this._quad;switch(this._opts.anchor){case BMAP_ANCHOR_TOP_LEFT:this._quad=2;break;case BMAP_ANCHOR_TOP_RIGHT:this._quad=1;break;case BMAP_ANCHOR_BOTTOM_LEFT:this._quad=3;break;case BMAP_ANCHOR_BOTTOM_RIGHT:this._quad=4;break;default:break}l.rc(i,"quad"+e);l.ac(i,"quad"+this._quad)},_setBtnPosition:function(){if(!l.Browser.ie){switch(this._quad){case 2:this._omBtn.style.top="0";this._omBtn.style.left="0";break;case 1:this._omBtn.style.top="0";this._omBtn.style.right="0";break;case 4:this._omBtn.style.bottom="0";this._omBtn.style.right="0";break;case 3:this._omBtn.style.bottom="0";this._omBtn.style.left="0";break;default:break}}else{var aU=this._btnWidth;var i=this._btnHeight;var e=this._opts.size.width;var aT=this._opts.size.height;this._omBtn.style.left="auto";this._omBtn.style.top="auto";this._omBtn.style.right="auto";this._omBtn.style.bottom="auto";switch(this._quad){case 2:this._omBtn.style.left="0px";this._omBtn.style.top="0px";break;case 1:this._omBtn.style.left=e-aU+"px";this._omBtn.style.top="0px";break;case 4:this._omBtn.style.top=aT-i+"px";this._omBtn.style.left=e-aU+"px";break;case 3:this._omBtn.style.left="0px";this._omBtn.style.top=aT-i+"px";break;default:break}}},_moveView:function(){if(this._omView){this._omView.setPoint(this._map.getCenter())}},_onMainMoveEnd:function(i){switch(this._currentOp){case"dragMap":this._setOMViewMvPos();this._currentOp="";break;case"dragView":this._omViewMv.style.display="none";this._overviewMap.panTo(this._map.getCenter(),false,90);this._currentOp="";break;default:if(this._overviewMap){this._overviewMap.panTo(this._map.getCenter(),false,90)}break}},_onMainZoomEnd:function(){if(!this._overviewMap){return}var e=this;e._curOMZoomLevel=e._getCurOMZoomLevel();setTimeout(function(){e._overviewMap.centerAndZoom(e._map.getCenter(),e._curOMZoomLevel);e._omView.setPoint(e._map.getCenter());e._setRatio()},100)},_onViewMapMoveEnd:function(){if(this._currentOp!="dragMap"){this._setOMViewMvPos();this._overviewMap.config.enableMouseDown=true}},remove:function(){P.prototype.remove.call(this);this._omCanvas=null;this._omMapContainer=null;this._omView=null;this._omViewInn=null;this._omViewMv=null;this._omViewMvInn=null;this._omBtn=null;this._overviewInitialized=false;this._overviewMap=null},isOpen:function(){if(!this._container){return false}return this._opts.isOpen}});l.extend(H.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map);this.dispatchEvent(new aw("ondomready"))}},initialize:function(e){P.prototype.initialize.call(this,e);this._initParam();this._setParam();this._render();this._bind();this._setSliderZoomLv(e.getZoom());this._bindMapEvent(e);return this._container},_initParam:function(){if(this._init){return}this._init=true;this._maxTotalZoomLv=18;this._minZoomLevel=-1;this._maxZoomLevel=-1;this._totalZoomLv=-1;this._sliderInterval=7;this._minBarY=1;this._maxBarY=-1;this._curBarY=-1;this._zoomDom=null;this._zoomBtnDom=null;this._sliderDom=null;this._sliderBaseDom=null;this._cZIndex="1100"},_bindMapEvent:function(i){var e=this;i.addEventListener("zoomend",function(aT){if(!e._map){return}e._setSliderZoomLv(e._map.getZoom());if(e._msover){return}if(e._isShowLevelHint){e._hideTimerId=setTimeout(function(){e._hideLevelHint()},1000)}});i.addEventListener("mousewheel",function(){if(!e._map){return}if(e._map.config.enableWheelZoom&&e._isShowLevelHint){if(e._hideTimerId){clearTimeout(e._hideTimerId);e._hideTimerId=null}e._showLevelHint()}});i.addEventListener("load",function(aT){if(!e._map){return}e._setSliderZoomLv(e._map.getZoom())});i.addEventListener("maptypechange",function(aT){if(!e._map){return}e.redraw()})},redraw:function(){this._setParam();this.setType(this._opts.type);if(this._map){this._setSliderZoomLv(this._map.getZoom())}},_setParam:function(){this._minZoomLevel=this._map.config.zoomLevelMin;this._maxZoomLevel=this._map.config.zoomLevelMax;if(this._minZoomLevel!=aJ[BMAP_NORMAL_MAP].zoomLevelMin||this._maxZoomLevel!=aJ[BMAP_NORMAL_MAP].zoomLevelMax){this._isShowLevelHint=false}else{this._isShowLevelHint=true}if(!this._opts.showZoomInfo){this._isShowLevelHint=false}this._totalZoomLv=this._maxZoomLevel-this._minZoomLevel+1;this._maxBarY=this._minBarY+(this._totalZoomLv-1)*this._sliderInterval},_render:function(){P.prototype._render.call(this);var aT=l.Browser.ie==6?" BMap_ie6":"";var i=" BMap_stdMpType"+this._opts.type;var aU=this._container;l.ac(aU,"BMap_stdMpCtrl");l.ac(aU,aT);l.ac(aU,i);aU.innerHTML=this._generateHtml(this._opts.type);this._setSliderBarCursor(l.Browser.opera?"pointer":aQ.defaultCursor);this._zoomDom=l.G(aU.children[1]);var e=this._zoomDom;this._zoomBtnDom=l.G(e.children[0]);this._sliderDom=l.G(e.children[1]);this._sliderBaseDom=l.G(e.children[1].children[0]);this._sliderBotDom=l.G(e.children[1].children[1]);this.setType(this._opts.type)},_setSliderHeight:function(){var a0=this._opts.type;var e=this._getControlHeight(a0);var aY=e.width;var i=e.height;var aV=e.zoomHeight;var aZ=e.zoomWidth;var aT=e.sliderHeight;var aW=e.sliderCHeight;var aU=(this._maxTotalZoomLv-this._totalZoomLv)*this._sliderInterval;if(this._opts.type==BMAP_NAVIGATION_CONTROL_LARGE){i=i-aU>=0?i-aU:0;aV=aV-aU>=0?aV-aU:0;aT=aT-aU>=0?aT-aU:0;aW=aW-aU>=0?aW-aU:0;sliderBotDomTop=124-aU>=0?124-aU:0;this._sliderBotDom.style.top=sliderBotDomTop+"px"}this._container.style.width=aY+"px";this._container.style.height=i+"px";this._zoomDom.style.height=aV+"px";this._zoomDom.style.width=aY+"px";this._zoomBtnDom.style.height=aV+"px";this._zoomBtnDom.style.width=aZ+"px";this._sliderDom.style.height=aT+"px";this._sliderBaseDom.style.height=aW+"px";var aX=this._zoomBtnDom.children;if(this._opts.type==BMAP_NAVIGATION_CONTROL_ZOOM){aX[0].style.left=aX[1].style.left="0"}else{aX[0].style.left=aX[1].style.left=""}},_getControlHeight:function(e){var i=[{width:this._opts.showZoomInfo?52:37,height:226,zoomHeight:167,zoomWidth:37,sliderHeight:133,sliderCHeight:124},{width:37,height:97,zoomHeight:38,zoomWidth:37,sliderHeight:0,sliderCHeight:0},{width:37,height:57,zoomHeight:0,zoomWidth:0,sliderHeight:0,sliderCHeight:0},{width:18,height:38,zoomHeight:38,zoomWidth:18,sliderHeight:0,sliderCHeight:0}];return i[e]},_generateHtml:function(){var e=[];e.push(this._generatePanHtml());e.push(this._generateZoomContainerHtml());return e.join("")},_generatePanHtml:function(){var e=\'<div class="BMap_stdMpPan"><div class="BMap_button BMap_panN" title="\u5411\u4e0a\u5e73\u79fb"></div><div class="BMap_button BMap_panW" title="\u5411\u5de6\u5e73\u79fb"></div><div class="BMap_button BMap_panE" title="\u5411\u53f3\u5e73\u79fb"></div><div class="BMap_button BMap_panS" title="\u5411\u4e0b\u5e73\u79fb"></div><div class="BMap_stdMpPanBg BMap_smcbg"></div></div>\';return e},_generateZoomContainerHtml:function(){var e=\'<div class="BMap_stdMpZoom">\'+this._generateZoomHtml()+this._generateSliderHtml()+this._generateZoomBalloonHtml()+"</div>";return e},_generateZoomHtml:function(){var e=\'<div><div class="BMap_button BMap_stdMpZoomIn" title="\u653e\u5927\u4e00\u7ea7"><div class="BMap_smcbg"></div></div><div class="BMap_button BMap_stdMpZoomOut" title="\u7f29\u5c0f\u4e00\u7ea7"><div class="BMap_smcbg"></div></div></div>\';return e},_generateSliderHtml:function(){var e=\'<div class="BMap_stdMpSlider"><div class="BMap_stdMpSliderBgTop"><div class="BMap_smcbg"></div></div><div class="BMap_stdMpSliderBgBot"><div class="BMap_smcbg"></div></div><div class="BMap_stdMpSliderMask" title="\u653e\u7f6e\u5230\u6b64\u7ea7\u522b"></div><div class="BMap_stdMpSliderBar" title="\u62d6\u52a8\u7f29\u653e"><div class="BMap_smcbg"></div></div></div>\';return e},_generateZoomBalloonHtml:function(){var e=\'<div class="BMap_zlHolder"><div class="BMap_zlSt"><div class="BMap_smcbg"></div></div><div class="BMap_zlCity"><div class="BMap_smcbg"></div></div><div class="BMap_zlProv"><div class="BMap_smcbg"></div></div><div class="BMap_zlCountry"><div class="BMap_smcbg"></div></div></div>\';return e},setType:function(e){if(typeof e=="number"&&e>=BMAP_NAVIGATION_CONTROL_LARGE&&e<=BMAP_NAVIGATION_CONTROL_ZOOM){this._opts.type=e}else{this._opts.type=BMAP_NAVIGATION_CONTROL_LARGE}if(!this._map||!this._container){return}var i=this._container;i.className=i.className.replace(/BMap_stdMpType\\d/,"BMap_stdMpType"+this._opts.type);this._setSliderHeight();if(e!=BMAP_NAVIGATION_CONTROL_LARGE){l.rc(i.children[1].children[2],"hvr")}this.setAnchor(this._opts.anchor)},getType:function(){return this._opts.type},_bind:function(){var aZ=this;var aY=aZ._container;l.on(this._zoomDom,"mouseover",function(){if(!aZ._isShowLevelHint){return}aZ._msover=true;if(aZ._hideTimerId){clearTimeout(aZ._hideTimerId);aZ._hideTimerId=null}aZ._showLevelHint()});l.on(this._zoomDom,"mouseout",function(){if(!aZ._isShowLevelHint){return}if(aZ._hideTimerId){clearTimeout(aZ._hideTimerId)}aZ._msover=false;aZ._hideTimerId=setTimeout(function(){aZ._hideLevelHint();aZ._hideTimerId=null},1000)});l.on(aY.children[0],"mouseover",function(){aZ._hideLevelHint(true)});l.on(aY.children[0].children[0],"click",function(){aZ._panBy(0,Math.round(aZ._map.height/3))});l.on(aY.children[0].children[1],"click",function(){aZ._panBy(Math.round(aZ._map.width/3),0)});l.on(aY.children[0].children[2],"click",function(){aZ._panBy(-Math.round(aZ._map.width/3),0)});l.on(aY.children[0].children[3],"click",function(){aZ._panBy(0,-Math.round(aZ._map.height/3))});var aW=aY.children[1].children[0].children;l.on(aW[0],"click",function(){aZ._zoomIn()});l.on(aW[1],"click",function(){aZ._zoomOut()});for(var aU=1;aU<6;aU++){l.on(aY.children[0].children[aU],"mouseup",function(i){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0&&(aZ._map.currentOperation&aL.drag)==0){ag(i)}});l.on(aY.children[0].children[aU],"contextmenu",function(i){D(i)});l.on(aY.children[0].children[aU],"click",function(i){D(i)})}l.on(aW[0],"mouseup",function(i){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0&&(aZ._map.currentOperation&aL.drag)==0){ag(i)}});l.on(aW[1],"mouseup",function(i){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0&&(aZ._map.currentOperation&aL.drag)==0){ag(i)}});l.on(aW[0],"contextmenu",function(i){D(i)});l.on(aW[1],"contextmenu",function(i){D(i)});var a0=aY.children[1].children[1].children[2];l.on(a0,"mouseup",function(i){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0&&(aZ._map.currentOperation&aL.drag)==0){ag(i)}});l.on(aW[0],"click",function(i){ag(i)});l.on(aW[1],"click",function(i){ag(i)});l.on(a0,"click",function(i){ag(i)});var aX=aY.children[1].children[1].children[3];l.on(aX,"mouseup",function(i){if(i.button==2){ag(i)}});l.on(aX,"contextmenu",function(i){D(i)});l.on(this._zoomDom.children[2].children[0],"click",function(i){aZ._map.zoomTo(18)});l.on(this._zoomDom.children[2].children[1],"click",function(i){aZ._map.zoomTo(12)});l.on(this._zoomDom.children[2].children[2],"click",function(i){aZ._map.zoomTo(8)});l.on(this._zoomDom.children[2].children[3],"click",function(i){aZ._map.zoomTo(4)});l.on(a0,"mousedown",function(a1){a1=window.event||a1;var i=0;if(typeof a1.layerY!="undefined"){i=a1.layerY}else{if(typeof a1.offsetY!="undefined"){i=a1.offsetY}}var a2=0;a2=(aZ._maxZoomLevel+1)-Math.round(aZ._totalZoomLv*parseFloat(i/(aZ._totalZoomLv*aZ._sliderInterval)));aZ._map.zoomTo(a2)});l.on(aX,"mouseover",function(){l.ac(aX,"h")});l.on(aX,"mouseout",function(){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0){l.rc(aX,"h")}});var aV=function(i){var i=window.event||i;if(i.button==2){return}if((l.Browser.ie&&i.button!=1)){return}if(aX.setCapture){aX.setCapture()}aZ._map.currentOperation|=aL.stdMapCtrlDrag;aZ._bind.my=i.pageY||i.clientY||0;if(!l.Browser.opera){aZ._setSliderBarCursor(aQ.draggingCursor)}l.on(document,"mousemove",e);l.on(document,"mouseup",aT);ag(i);return D(i)};var e=function(a1){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)!=0){var a1=window.event||a1;var a2=a1.pageY||a1.clientY;var i=aZ._curBarY+a2-aZ._bind.my;if(i<aZ._minBarY){aX.style.top=aZ._minBarY+"px"}else{if(i>aZ._maxBarY){aX.style.top=aZ._maxBarY+"px"}else{aX.style.top=i+"px"}}}};var aT=function(a1){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)!=0){var i=l.G(aX);aZ._curBarY=parseInt(i.style.top);l.rc(aX,"h");aZ._map.currentOperation&=~aL.stdMapCtrlDrag;if(aY&&aX&&aX.releaseCapture){aX.releaseCapture()}if(!l.Browser.opera){aZ._setSliderBarCursor(aQ.defaultCursor)}var a2=(aZ._maxZoomLevel+1)-Math.round(parseFloat(aZ._curBarY-aZ._minBarY)/parseFloat(aZ._maxBarY-aZ._minBarY)*(aZ._totalZoomLv-1)+1);aZ._map.zoomTo(a2);l.un(document,"mousemove",e);l.un(document,"mouseup",aT)}};l.on(aX,"mousedown",aV)},_setSliderBarCursor:function(e){this._container.children[1].children[1].children[3].style.cursor=e},_panBy:function(i,e){this._map.panBy(i,e)},_zoomIn:function(){this._map.zoomIn()},_zoomOut:function(){this._map.zoomOut()},_setSliderZoomLv:function(i){if(!this._container||this.getType()!=BMAP_NAVIGATION_CONTROL_LARGE){return}var e=(this._maxZoomLevel-i)*this._sliderInterval+this._minBarY;this._curBarY=e>this._maxBarY?this._maxBarY:e<this._minBarY?this._minBarY:e;this._container.children[1].children[1].children[3].style.top=this._curBarY+"px"},_hideLevelHint:function(e){if(this._opts.type==0){l.rc(this._container.children[1].children[2],"hvr")}if(e&&this._hideTimerId){clearTimeout(this._hideTimerId);this._hideTimerId=null}},_showLevelHint:function(){if(this._opts.type==0&&this._opts.showZoomInfo){l.ac(this._container.children[1].children[2],"hvr")}},show:function(){P.prototype.show.call(this);if(l.Browser.ie<8){var e=this;setTimeout(function(){e.setType(e._opts.type)},1)}}});l.extend(T.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){P.prototype.initialize.call(this,e);if(!this._init){this._scaleText=null;this._numberArray={};this._init=true}this._render();this._setParam();this._updateScale();this._bind(e);return this._container},_setParam:function(){this._numberArray={us:[5280*5000,5280*2500,5280*2000,5280*1000,5280*500,5280*200,5280*100,5280*50,5280*25,5280*20,5280*10,5280*5,5280*2,5280,2000,1000,500,200,100,50,20,10,5],metric:[10000000,5000000,2000000,1000000,500000,200000,100000,50000,25000,20000,10000,5000,2000,1000,500,200,100,50,20,10,5,2,1]}},_bind:function(i){var e=this;i.addEventListener("zoomend",function(aT){e._updateScale()});i.addEventListener("load",function(aT){e._updateScale()});i.addEventListener("moveend",function(aT){e._updateScale()})},_render:function(){P.prototype._render.call(this);l.ac(this._container,"BMap_scaleCtrl");this._container.innerHTML=this._generateHTML();this._scaleText=this._container.children[0];P.prototype._setPosition.call(this)},_generateHTML:function(){var e=\'<div class="BMap_scaleTxt" unselectable="on"></div><div class="BMap_scaleBar BMap_scaleHBar"><img style="border:none" src="\'+aQ.imgPath+\'mapctrls11.png" /></div><div class="BMap_scaleBar BMap_scaleLBar"><img style="border:none" src="\'+aQ.imgPath+\'mapctrls11.png" /></div><div class="BMap_scaleBar BMap_scaleRBar"><img style="border:none" src="\'+aQ.imgPath+\'mapctrls11.png" /></div>\';return e},setUnit:function(e){this._opts.unit=this._units[e]&&this._units[e].name||this._opts.unit;if(!this._map){return}this._updateScale()},_setScaleText:function(i,e){if(typeof i!="number"||typeof e!="string"){return}this._scaleText.innerHTML=i+"&nbsp;"+e},_updateScale:function(){if(!this._map||!this._container){return}var aW=this._map.config.coordType;var i=aW==BMAP_COORD_LNGLAT?10:500000;var aV=new f(this._map.getCenter().lng,this._map.getCenter().lat+i);var aX=Math.abs(this._map.pointToPixel(this._map.getCenter()).y-this._map.pointToPixel(aV).y);var a1;if(aW==BMAP_COORD_LNGLAT){a1=V.getDistanceByLL(this._map.getCenter(),aV)/aX}else{if(aW==BMAP_COORD_MERCATOR){a1=V.getDistanceByMC(this._map.getCenter(),aV)/aX}}if(a1==0||isNaN(a1)){return}var aZ=this._convertUnit(a1,this._opts.unit);var e=0;var aT=this._units[this._opts.unit].incon;var aY=this._map.getZoom();var aU=this._numberArray[this._opts.unit][this._map.getZoom()-1];e=aU/aZ;var a0=aU>=aT?this._units[this._opts.unit].u2:this._units[this._opts.unit].u1;if(aU>=aT){aU=Math.round(aU/aT)}this._setScaleText(aU,a0);if(Math.round(e)%2!=0&&l.Browser.ie==6){e=e+1}this._container.style.width=Math.round(e)+"px";if(this._map.mapType==BMAP_PERSPECTIVE_MAP){this._container.style.width=Math.round(e)*3+"px";this._setScaleText(aU*3,a0)}},_convertUnit:function(e,i){i=i||"metric";if(this._units[i]){return e*this._units[i].conv}return e}});l.extend(ae.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(aT){P.prototype.initialize.call(this,aT);P.prototype._render.call(this);P.prototype._setPosition.call(this);this.mapTypeSpans={};l.extend(this._container.style,{cursor:"pointer",height:"22px",top:"10px",width:"82px",zIndex:"800"});var i=t("span");l.extend(i.style,{background:"transparent url("+aQ.imgPath+"mapctrls.gif) no-repeat 0 -152px",cursor:"pointer",height:"22px",width:"41px",zIndex:"800",display:"inline-block"});i.title="\u663e\u793a\u666e\u901a\u5730\u56fe";this._container.appendChild(i);this.mapTypeSpans.B_NORMAL_MAP=i;i=t("span");l.extend(i.style,{background:"transparent url("+aQ.imgPath+"mapctrls.gif) no-repeat -41px -152px",cursor:"pointer",height:"22px",width:"41px",zIndex:"800",display:"inline-block"});i.title="\u663e\u793a\u4e09\u7ef4\u5730\u56fe";this._container.appendChild(i);this.mapTypeSpans.B_DIMENSIONAL_MAP=i;i=null;this._bind(aT);var e=this;e.select(this._map.mapType);return this._container},_bind:function(aT){var i=this;var aU=this.mapTypeSpans.B_NORMAL_MAP;var e=this.mapTypeSpans.B_DIMENSIONAL_MAP;aU.onmousedown=function(){this.style.backgroundPosition="0 -130px";e.style.backgroundPosition="-41px -130px"};aU.onclick=function(){i._toggle("B_NORMAL_MAP")};e.onmousedown=function(){this.style.backgroundPosition="-41px -152px";aU.style.backgroundPosition="0 -152px"};e.onclick=function(){i._toggle("B_DIMENSIONAL_MAP")};aT.addEventListener("onmaptypechange",function(aV){i.select(aT.mapType)})},_toggle:function(aU){if(this._map.mapType==aU){return}var i=0;if(this._map.currentCity!=""){i=1}var aV=new aw("onbeforesetmaptype");aV.flag=i;aV.mapType=aU;this._map.dispatchEvent(aV);var aT=this;if(aT._opts.enableSwitch){if(i||aU=="B_NORMAL_MAP"){aT.select(aU)}return}},select:function(e){if(e=="B_NORMAL_MAP"){this.mapTypeSpans.B_NORMAL_MAP.style.backgroundPosition="0 -130px";this.mapTypeSpans.B_DIMENSIONAL_MAP.style.backgroundPosition="-41px -130px"}if(e=="B_DIMENSIONAL_MAP"){this.mapTypeSpans.B_DIMENSIONAL_MAP.style.backgroundPosition="-41px -152px";this.mapTypeSpans.B_NORMAL_MAP.style.backgroundPosition="0 -152px"}this._map.setMapType(e)},remove:function(){this.mapTypeSpans.B_DIMENSIONAL_MAP=this.mapTypeSpans.B_NORMAL_MAP=null;P.prototype.remove.call(this)}});');
﻿_jsload&&_jsload('marker', 'l.extend(aF.prototype,{initialize:function(e){this.map=e;this._addDom();this._bind();this.domElement.hashCode=this.hashCode;l.BaseClass.call(this,this.hashCode);if(!this._visible){l.hide(this.domElement)}this.dispatchEvent(new aw("ondomready"));return this.domElement},_bind:function(){if(!this.domElement){return}var e=this;var aT=this.map;function i(aX,aW){var aV=aX.srcElement||aX.target;var aU=aX.clientX||aX.pageX;var aZ=aX.clientY||aX.pageY;if(aX&&aW&&aU&&aZ&&aV){var aY=l.Dom.getOffset(aT.container);aW.pixel=new aK(aU-aY.left,aZ-aY.top);aW.point=aT.pixelToPoint(aW.pixel);return aW}else{return aW}}l.on(this.domElement,"mouseover",function(aU){if(!e._dragstarted){e.dispatchEvent(i(aU,new aw("onmouseover").inherit(aU)))}});l.on(this.domElement,"mouseout",function(aU){if(!e._dragstarted){e.dispatchEvent(i(aU,new aw("onmouseout").inherit(aU)))}});if(e._config.clickable){l.on(this.domElement,"touchstart",function(aU){e._bind._touchStartPos=new aK(aU.changedTouches[0].clientX,aU.changedTouches[0].clientY)});l.on(this.domElement,"touchend",function(aW){var aV=new Date().getTime(),aU=new aK(aW.changedTouches[0].clientX,aW.changedTouches[0].clientY);if(Math.abs(aU.x-e._bind._touchStartPos.x)>10||Math.abs(aU.y-e._bind._touchStartPos.y)>10){e._bind._touchStartPos=null;return}e.dispatchEvent(i(aW,new aw("onclick").inherit(aW)));if(aV-e._dblclickTime<e.map.config.clickInterval){e.dispatchEvent(i(aW,new aw("ondblclick").inherit(aW)))}e._dblclickTime=aV});l.on(this.domElement,"click",function(aV){var aU=aV.srcElement||aV.target;while(aU){if(aU==e.domElement){if(e.toString()!="Marker"||e.toString()=="Marker"&&(!e._lastPt||e._lastPt&&e.getPoint().equals(e._lastPt))){e.dispatchEvent(i(aV,new aw("onclick").inherit(aV)))}break}else{if(e.map.infoWindowDoms&&aU==e.map.infoWindowDoms.popDom){break}}aU=aU.parentNode}});l.on(this.domElement,"dblclick",function(aU){e.dispatchEvent(i(aU,new aw("ondblclick").inherit(aU)));aC(aU)})}l.on(this.domElement,"mousedown",function(aU){if(e.toString()=="Marker"){e._lastPt=e.getPoint()}e.dispatchEvent(i(aU,new aw("onmousedown").inherit(aU)))});l.on(this.domElement,"mouseup",function(aU){e.dispatchEvent(i(aU,new aw("onmouseup").inherit(aU)))});l.on(this.domElement,"contextmenu",function(aU){e.dispatchEvent(i(aU,new aw("onrightclick").inherit(aU)))})},hide:function(){if(this._visible==false){return}this._visible=false;O.prototype.hide.call(this);if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay==this){this.closeInfoWindow()}},show:function(){if(this._visible==true){return}this._visible=true;O.prototype.show.call(this)},setStyle:function(e){if(this.domElement){if(this.siblingElement){this.siblingElement.style.cssText=this.siblingElement.style.cssText+";"+e}else{this.domElement.style.cssText=this.domElement.style.cssText+";"+e}}},setConfig:function(i){if(!i){return}for(var e in i){if(typeof(this._config[e])==typeof(i[e])){this._config[e]=i[e]}}},getPoint:function(aT,aU){if(!aT){return this.point}else{var e=aU?aU.width:0;var aV=aU?aU.height:0;if(this.map){var i=this.map.pointToPixel(this.point);if(this._config&&this._config.offset){i.x=i.x+this._config.offset.width+e;i.y=i.y+this._config.offset.height+aV}else{i.x=i.x+e;i.y=i.y+aV}return this.map.pixelToPoint(i)}}},setZIndex:function(e){var i=this;i.zIndex=e;i._updateDomZIndex()},_updateDomZIndex:function(){var i=this,e;if(typeof i.zIndex!="undefined"){e=i.zIndex}else{e=0;if(i.map&&i.getPoint()){var aT=i.getPoint()?i.getPoint().lat:0;e=O.getZIndex(aT,i.map.config.coordType)+(i._config.baseZIndex||0)}}if(i.domElement){i.domElement.style.zIndex=e}},isVisible:function(){if(!this.domElement){return false}return !!this._visible}});J.TOP_ZINDEX=O.getZIndex(-90)+1000000;J.DRAG_ZINDEX=J.TOP_ZINDEX+1000000;l.extend(J.prototype,{initialize:function(e){aF.prototype.initialize.call(this,e);if(!this._visible){l.hide(this.siblingElement)}this.setPoint(this.point);this.setIcon(this._config.icon);if(this._config.label&&this._cfgLabelEvent){this._config.label.addEventListener("remove",this._cfgLabelEvent)}this.setLabel(this._config.label);this.setTitle(this._config.title);this._initDrag();return this.domElement},_addDom:function(){var e=this.map;this.domElement=Z(e.getPanes().markerMouseTarget,this._msTargetRender());this.siblingElement=Z(e.getPanes().markerPane,this._markerRender());this.siblingElement.hashCode=this.getHashCode()},_msTargetRender:function(){var e=[\'<span class="BMap_Marker BMap_noprint" unselectable="on" \'];e.push(this._config.title?\'title="\'+this._config.title+\'"\':\'"\');e.push(\' style="position:absolute;padding:0;margin:0;border:0;width:0;height:0;-moz-user-select:none;\');e.push(this._config.clickable?"cursor:pointer;":"");e.push("background:url("+aQ.imgPath+"blank.gif);");e.push("width:"+this._config.icon.size.width+"px;");e.push("height:"+this._config.icon.size.height+"px;");e.push(\'"></span>\');return e.join("")},_markerRender:function(){var e=[\'<span class="BMap_Marker" unselectable="on" \'];e.push(\'style="position:absolute;padding:0;margin:0;border:0;\');e.push(\'width:0;height:0;-moz-user-select:none"></span>\');return e.join("")},draw:function(){if(this.domElement){var aT=this._config.offset||new X(0,0);var i=this._config.icon.offset||new X(0,0);var e=this.map.pointToOverlayPixel(this.getPoint());this.domElement.style.left=(e.x+aT.width-i.width)+"px";this.domElement.style.top=(e.y+aT.height-i.height)+"px";if(this.siblingElement){this.siblingElement.style.left=(e.x+aT.width)+"px";this.siblingElement.style.top=(e.y+aT.height)+"px"}if(this.infoWindow!=null&&this.infoWindow.isOpen()){this.infoWindow.setPosition()}this._updateDomZIndex()}},_draw:function(){if(this.map){this.domElement=this.initialize(this.map)}},remove:function(){if(this.siblingElement&&this.siblingElement.parentNode){this.siblingElement.parentNode.removeChild(this.siblingElement)}if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay===this){this.closeInfoWindow();this.infoWindow=null}this.siblingElement=null;this.iconDom=null;if(this._config.label){this._config.label.removeEventListener("remove",this._cfgLabelEvent);this._config.label.decontrol();this._config.label.setMarker(null);this._config.label.domElement=null;this._config.label=null}aF.prototype.remove.call(this)},hide:function(){aF.prototype.hide.call(this);if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay==this){this.closeInfoWindow()}l.hide(this.domElement);l.hide(this.siblingElement)},show:function(){aF.prototype.show.call(this);l.show(this.domElement);l.show(this.siblingElement)},setIcon:function(aU){if(!aU||aU.toString()!="Icon"){return}this._config.icon=aU;if(!this.map||!this.domElement||!this.siblingElement){return}var aW=this.map;try{if(this.iconDom){this.siblingElement.removeChild(this.iconDom);this.iconDom=null}this.domElement.style.width=aU.size.width+"px";this.domElement.style.height=aU.size.height+"px"}catch(aV){}if(this._config.icon){var i=this.iconDom=t("div",{"class":this.iconClassName});var aT=i.style;aT.position="absolute";aT.padding=aT.margin="0";aT.width=aU.size.width+"px";aT.height=aU.size.height+"px";aT.left=-aU.offset.width+"px";aT.top=-aU.offset.height+"px";aT.overflow="hidden";i.innerHTML=aU.getHTML();i.galleryImg=false;this.siblingElement.appendChild(this.iconDom)}this.draw()},setIconClassName:function(e){if(this.iconDom){this.iconDom.className=e}},getIcon:function(){return this._config.icon},setLabel:function(e){if(!e||e.toString()!="Label"){return}this._config.label=e;var aT=this;if(!this._config.label._binded){this._config.label._binded=true;this._cfgLabelEvent=function(){aT._config.label=null};this._config.label.addEventListener("remove",this._cfgLabelEvent)}if(!this.map){return}e._i(this.map);if(e.domElement){this.siblingElement.appendChild(e.domElement)}else{e.domElement=Z(this.domElement,e.render());e.domElement.hashCode=e.getHashCode()}var i=e.domElement.style;i.left=(e._config.offset.width)+"px";i.top=(e._config.offset.height)+"px";e.setMarker(this)},getLabel:function(){return this._config.label},_initDrag:function(){if(!this.domElement||this.domElement._binded){return}this.domElement._binded=true;var aX=this.map,aU=this,e=0,aY=0,aT=0,aW={x:0,y:0};function aV(a0,aZ){aZ.pixel=a0.pixel;aZ.point=a0.point;return aZ}function i(a1){var a0=a1.clientX,aZ=a1.clientY;if(a1.changedTouches){a0=a1.changedTouches[0].clientX;aZ=a1.changedTouches[0].clientY}return new aK(a0,aZ)}this.dragStart=function(a1){if(!aU._config.enableDragging){return}aU._isDragging=true;var a0=aX.pointToPixel(aU.point);var aZ=i(a1);e=aZ.x-a0.x;aY=aZ.y-a0.y;aT=new Date().getTime();aU.map.temp._draggingMarker=aU;l.on(document,"mousemove",aU.dragIng);l.on(document,"mouseup",aU.dragEnd);l.on(document,"touchmove",aU.dragIng);l.on(document,"touchend",aU.dragEnd);if(aU.domElement&&aU.domElement.setCapture){aU.domElement.setCapture()}};this.dragIng=function(a3){if(!aU._isDragging){return}var a0=i(a3);var a1=new aK((a0.x-e),(a0.y-aY));aW=a1;if((aU._config.restrictDraggingArea&&(a1.x>15&&a1.x<aU.map.width-15)&&(a1.y>30&&a1.y<aU.map.height-15))||!aU._config.restrictDraggingArea){var aZ=aU.map.pixelToPoint(a1),a2={pixel:a1,point:aZ};aU.setPoint(aZ);if(!aU._dragstarted){aU.dispatchEvent(aV(a2,new aw("ondragstart").inherit(a3)));aU._dragstarted=true}aU.dispatchEvent(aV(a2,new aw("ondragging").inherit(a3)))}};this.dragEnd=function(aZ){if(aU.domElement&&aU.domElement.releaseCapture){aU.domElement.releaseCapture()}aU._isDragging=false;aU.map.temp._draggingMarker=null;l.un(document,"mousemove",aU.dragIng);l.un(document,"mouseup",aU.dragEnd);l.un(document,"touchmove",aU.dragIng);l.un(document,"touchend",aU.dragEnd);e=aY=0;if((new Date()).getTime()-aT>=100&&(aW.x>2||aW.y>2)){aU._dragstarted=false;aU.dispatchEvent(aV({pixel:aU.map.pointToPixel(aU.getPoint()),point:aU.getPoint()},new aw("ondragend").inherit(aZ)))}aU._updateDomZIndex()};l.on(this.domElement,"mousedown",this.dragStart);l.on(this.domElement,"touchstart",this.dragStart)},enableDragging:function(e){this._config.enableDragging=true},disableDragging:function(){this._config.enableDragging=false},setPoint:function(e){if(e&&e.toString()=="Point"){this.point=this._config.point=new f(e.lng,e.lat);this.draw()}},_updateDomZIndex:function(){var i=this,e;if(i._isDragging==true){e=J.DRAG_ZINDEX}else{if(i._config.isTop==true){e=J.TOP_ZINDEX+(i._addi||0)}else{if(typeof i.zIndex!="undefined"){e=i.zIndex}else{e=0;if(i.map&&i.getPoint()){e=O.getZIndex(i.getPoint().lat,i.map.config.coordType)+i._config.baseZIndex}}}}if(i.domElement){i.domElement.style.zIndex=e}if(i.siblingElement){i.siblingElement.style.zIndex=e}},setTop:function(i,e){this._config.isTop=!!i;if(i){this._addi=e||0}this._updateDomZIndex()},setTitle:function(e){this._config.title=e;if(this.domElement){this.domElement.title=e||""}},getTitle:function(){return this._config.title||""},setOffset:function(e){if(!e||e.toString()!="Size"){return}this._config.offset=e;this.setPoint(this.getPoint())},getOffset:function(){return this._config.offset}});var R=w.prototype;R.getHTML=function(){if(l.Browser.ie==6&&this.imageUrl.toLowerCase().indexOf(".png")>0){var e=["<div"];if(this.printImageUrl){e.push(\' class="BMap_noprint"\')}e.push(\' style="width: 1px; height: 1px;\');e.push("; left:"+this.imageOffset.width+"px");e.push("; top:"+this.imageOffset.height+"px");e.push("; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=image,src=\'"+this.imageUrl+"\')");e.push(\'; position:absolute;"></div>\');if(this.printImageUrl){e.push(\'<img class="BMap_noscreen" style="border:none;left:\'+this.imageOffset.width+"px;");e.push("top:"+this.imageOffset.height+\'px;position:absolute" src="\'+this.printImageUrl+\'" />\')}return e.join("")}else{return[\'<img src="\',this.imageUrl,\'" style="border:none;left:\'+this.imageOffset.width+"px","; top:"+this.imageOffset.height+"px",\'; position:absolute;" />\'].join("")}};l.extend(q.prototype,{_addDom:function(){var i=this._config;var aU=this.content;var e=t("label",{"class":"BMapLabel",unselectable:"on"});if(i.title){e.title=i.title}var aT=e.style;aT.position="absolute";aT.MozUserSelect="none";if(i.width==0||i.width=="auto"){aT.display="inline"}else{aT.width=i.width+"px";aT.display="block";aT.overflow="hidden"}if(i.clickable=="true"){aT.cursor="pointer"}else{if(!l.Browser.ie){aT.cursor="inherit"}}e.innerHTML=aU;this.map.getPanes().labelPane.appendChild(e);this.domElement=e;this.setStyle(i.styles);return e},setPoint:function(e){if(e&&e.toString()=="Point"&&!this.getMarker()){this.point=this._config.point=new f(e.lng,e.lat);this.draw()}},draw:function(){if(this.domElement&&this.getPoint()&&!this.getMarker()){var i=this._config.offset||new X(0,0);var e=this.map.pointToOverlayPixel(this.getPoint());this.domElement.style.left=(e.x+i.width)+"px";this.domElement.style.top=(e.y+i.height)+"px";this._updateDomZIndex()}},_draw:function(){if(this.map&&!this._marker){this.domElement=this.initialize(this.map);this.draw()}},setContent:function(e){this.content=e;if(this.domElement){this.domElement.innerHTML=e}},setOpacity:function(e){if(e>=0&&e<=1){this._config.opacity=e}if(this.domElement){B(this.domElement,e)}},setOffset:function(e){if(!e||e.toString()!="Size"){return}this._config.offset=new X(e.width,e.height);if(this.getMarker()&&this.domElement){this.domElement.style.left=e.width+"px";this.domElement.style.top=e.height+"px"}else{this.draw()}},setStyle:function(i){i=i||{};this._config.styles=l.extend(this._config.styles,i);if(this.domElement){for(var aU in i){try{this.domElement.style[aU]=i[aU]}catch(aT){}}}},setTitle:function(e){this._config.title=e||"";if(this.domElement){this.domElement.title=this._config.title}}});');
﻿_jsload&&_jsload('infowindow', 'l.extend(ay.prototype,{initialize:function(i){var aT=this.map=i.map;this.overlay=i;this.render();this._bind();if(this._config.enableMaximize){this.enableMaximize()}else{this.disableMaximize()}this.setTitle(this._config.title);this.setContent(this.content);if(this._config.ifMaxScene){this.setMaxScene(true)}this.redraw(null,true);var e=aT.infoWindowDoms;if(e){if(i.toString()=="Marker"){e.marker=i}else{e.marker=null}}},render:function(){var aX=this.map,aU=this,i=aX.infoWindowDoms,aY=aU.IMG_PATH;if(!i){i=aX.infoWindowDoms={};aX.infoWindow=aX.infoWindowDoms;var aT=[\'<div class="shadow" style="position: absolute;display:none" type="infowindow_shadow">\'];aT.push(\'<div><img onmousedown="return false" style="left: -323px; top: 0px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="left: -393px; top: 0px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="left: -1033px; top: 0px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="top: -30px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="left: -360px; top: -30px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="top: -30px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="left: -14px; top: -310px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="left: -255px; top: -310px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="left: -440px; top: -310px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="left: -255px; top: -310px;" src="\'+aY+\'iws3.png"/></div>\');aT.push(\'<div><img onmousedown="return false" style="left: -754px; top: -310px;" src="\'+aY+\'iws3.png"/></div>\');aT.push("</div>");aT.push(\'<div class="pop" style="position:absolute;display:none;cursor:default">\');aT.push(\'<div><img style="border:none;margin:0px;padding:0px;position:absolute;left:0px;top:0px;width:690px;height:786px;" src="\'+aY+\'iw3.png"/></div>\');aT.push(\'<div class="top"><img src="\'+aY+\'iw3.png" style="position:absolute; left: -65px; top: -60px;"/></div>\');aT.push(\'<div><img style="border:none;margin:0px;padding:0px;position:absolute;left:-665px;top:0px;width:690px;height:786px;" src="\'+aY+\'iw3.png"/></div>\');aT.push(\'<div class="center"><img src="\'+aY+\'iw3.png" style="position:absolute;left:-65px;top:-60px;"/></div>\');aT.push(\'<div><img style="border:none;margin:0px;padding:0px;position:absolute;left:0px;top:-665px;width:690px;height:786px;" src="\'+aY+\'iw3.png"/></div>\');aT.push(\'<div class="bottom"><img src="\'+aY+\'iw3.png" style="position:absolute;left:-65px;top:-146px;"/></div>\');aT.push(\'<div><img style="border:none;margin:0px;padding:0px;position:absolute;left:-665px;top:-665px;width:690px;height:786px;" src="\'+aY+\'iw3.png"/></div>\');aT.push(\'<div><img style="border:none;margin:0px;padding:0px;position:absolute;left:-186px;top:-691px;width:690px;height:786px;" src="\'+aY+\'iw3.png"/></div>\');aT.push(\'<div style="overflow-y:hidde;overflow-x:hidde;width:auto;height:auto;position:absolute;left:16px; top:16px;z-index:10;"></div>\');aT.push("</div>");i.popDom=Z(aX.platform,aT.join(""));i.shadowDom=i.popDom.previousSibling;i.popDivs=i.popDom.getElementsByTagName("div");i.shadowDivs=i.shadowDom.getElementsByTagName("div");i.contentMain=i.popDivs[8];i.titleDiv=Z(i.popDivs[8],\'<div class="BMap_bubble_title" style="display:block;overflow:hidden;height:24px;line-height:24px;white-space:nowrap"></div>\');i.contentDiv=Z(i.popDivs[8],\'<div class="BMap_bubble_content" style="display:block"></div>\');i.maxContentDiv=Z(i.popDivs[8],\'<div class="BMap_bubble_max_content" style="display:none;position:relative"></div>\');var e=12;if(l.Platform.iphone||l.Platform.android){e=20}var aV=\'<img style="position:absolute;top:12px;width:\'+e+"px;height:"+e+\'px;-moz-user-select:none;cursor:pointer;z-index:10000;" src="\'+aY+\'iw_close.gif"/>\';i.closeButton=Z(i.popDom,aV);var aW=\'<img style="position:absolute;top:12px;width:\'+e+"px;height:"+e+\'px;-moz-user-select:none;cursor:pointer;z-index:10000;display:none" src="\'+aY+\'iw_plus.gif"/>\';i.maxButton=Z(i.popDom,aW);this._mendIE6(i)}i.hashCode=i.popDom.hashCode=this.hashCode},_mendIE6:function(aV){if(l.isIE>6||l.isIE==0){return}var aU=aV.popDom.getElementsByTagName("IMG");for(var aT=0;aT<aU.length;aT++){aU[aT].style.cssText+=";FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+aU[aT].src+",sizingMethod=crop)";aU[aT].src=this.IMG_PATH+"blank.gif"}var e=aV.shadowDom.getElementsByTagName("IMG");for(var aT=0;aT<e.length;aT++){e[aT].style.cssText+=";FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+e[aT].src+",sizingMethod=crop)";e[aT].src=this.IMG_PATH+"blank.gif"}},_bind:function(){var aX=this,aY=aX.map,aU=aY.infoWindowDoms,aT=aU.closeButton,aV=aU.popDom;var i=function(aZ){if(aX.hide()==true){aX.dispatchEvent(new aw("onclickclose"))}aC(aZ)};aT.onclick=i;var aW=["touchstart","touchmove","gesturestart","gesturechange","mousedown","mouseout","mouseover","click","mousewheel","keydown","selectstart"];l.each(aW,function(aZ){l.on(aV,aZ,ag)});l.on(aV,"dblclick",aC);l.on(aV,"contextmenu",aC);if(window.addEventListener){aV.addEventListener("DOMMouseScroll",ag,false)}var e=function(a0){var aZ=aX.map.infoWindowDoms.maxButton;if(!aX.isWinMax){aX.maximize()}else{aX.restore()}aC(a0)};aU.maxButton.onclick=e;if(l.Platform.iphone||l.Platform.ipad||l.Platform.android){l.on(aT,"touchend",i);l.on(aU.maxButton,"touchend",e)}aV=aT=aU=null},_setWinSize:function(a1,a0){var bb=this._config;a1=a1||bb.width;a0=a0||bb.height;if(a0<0){a0=0}var aV=bb.offset.width;var aZ=bb.offset.height;var ba=[25,-1,25,-1,25,-1,25,34];var aU=[25,-1,25,-1,25,-1,25,50];ba[1]=a1-ba[0]-ba[2];if(l.isIE&&document.compatMode!="CSS1Compat"){ba[3]=a1}else{ba[3]=a1-2}ba[5]=a1-ba[4]-ba[6];aU[1]=aU[0];aU[3]=a0-aU[0]-aU[4];if(l.isIE&&document.compatMode!="CSS1Compat"){aU[5]=aU[4]}else{aU[5]=aU[4]-1}var bc=[0,ba[0],a1-ba[2],0,0,ba[4],a1-ba[6],Math.ceil((a1-ba[7])/2)];var a6=[0,0,0,ba[0],a0-ba[4],a0-ba[4],a0-ba[4],a0-ba[4]];var aT=this._allPopLeft=aV-Math.round((a1-ba[7])/2);var a7=this._allPopTop=aZ-a0-24;var bd=Math.floor((a0+aU[7])/2.03)+30;var aX=[70,-1,70,-1,-1,-1,50,-1,140,-1,70];var a5=[30,30,30,25,25,25,60,60,60,60,60];aX[7]=Math.round((a1+80-(aX[6]+aX[8]+aX[10])-50)/2);aX[9]=aX[7]+50;var a9=aX[6]+aX[7]+aX[8]+aX[9]+aX[10];aX[1]=a9-aX[0]-aX[2]-29;aX[5]=aX[3]=bd-a5[0]-a5[6]+70;a5[3]=a5[4]=a5[5]=bd-a5[0]-a5[6];aX[4]=(aX[0]+aX[1]+aX[2]+a5[3]+29)-aX[5]-aX[3];var e=[bd-60-1,bd-60-1+aX[0],bd-60-1+aX[0]+aX[1],29,29+aX[3],29+aX[3]+aX[4],0,aX[6],aX[6]+aX[7],aX[6]+aX[7]+aX[8],aX[6]+aX[7]+aX[8]+aX[9]];var a4=[0,0,0,a5[0],a5[0],a5[0],a5[0]+a5[3],a5[0]+a5[3],a5[0]+a5[3],a5[0]+a5[3],a5[0]+a5[3]];this._allShadowLeft=aV-aX[6]-aX[7]-70;this._allShadowTop=aZ-bd+30;var aW=323-bd+90;shadowRightImageLeft=740+aW;var a8=function(i){return"overflow: hidden; z-index: 1; position: absolute;              left:"+bc[i]+"px;              top:"+a6[i]+"px;              width:"+ba[i]+"px;              height:"+aU[i]+"px"};var a2=function(i){return"overflow: hidden; z-index: 1; position: absolute;              left:"+e[i]+"px;              top:"+a4[i]+"px;              width:"+aX[i]+"px;              height:"+a5[i]+"px;"};var aY=this.map.infoWindowDoms;if(aY&&aY.popDivs){for(var a3=0;a3<8;a3++){aY.popDivs[a3].style.cssText=a8(a3)}}if(aY&&aY.shadowDivs){for(var a3=0;a3<aY.shadowDivs.length;a3++){aY.shadowDivs[a3].style.cssText=a2(a3)}aY.shadowDivs[3].firstChild.style.left="-"+aW+"px";aY.shadowDivs[5].firstChild.style.left="-"+shadowRightImageLeft+"px"}this.setPosition()},setWidth:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<220){e=220}if(e>730){e=730}}this._config.width=e;if(this._isMyDom()&&this.isOpen()){var i=this;this.redraw(function(){i.setPanToWithDelay()})}},setHeight:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<60){e=60}if(e>650){e=650}}this._config.height=e;var aT=this.map;if(this._isMyDom()&&this.isOpen()){if(this._config.width!=0){aT.infoWindowDoms.contentDiv.style.width=this._config.width+"px"}var i=this;this.redraw(function(){i.setPanToWithDelay()})}},setMaxWidth:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<220){e=220}if(e>730){e=730}}this._config.maxWidth=e;if(this.isWinMax){this.redraw()}},setTitle:function(aT){var i=this.map;this._config.title=aT||"";if(!this._isMyDom()){return}var e=i.infoWindowDoms.titleDiv;if(!aT){l.hide(e)}else{e.innerHTML=aT;l.show(e)}this.redraw()},setContent:function(aT){aT=aT||this.content;var aU=this.map;this.content=aT;if(!this._isMyDom()){return}if(this.isWinMax){return}var i=aU.infoWindowDoms.contentDiv;var e=aU.infoWindowDoms.maxContentDiv;i.innerHTML=aT;if(this._config.width!=0){i.style.width=this._config.width+"px"}e.style.display="none";i.style.display=""},setMaxContent:function(i){if(!i){i=this._config.maxContent}else{this._config.maxContent=i}var aT=this.map;if(!this._isMyDom()){return}var e=aT.infoWindowDoms;e.maxContentDiv.innerHTML=i;if(!this.isWinMax){return}e.contentDiv.style.display="none";e.maxContentDiv.style.display=""},redraw:function(a1,aX){if(!this._isMyDom()){return}if(!aX&&!this.isOpen()){return}var aT=this,aW=100,aU=aT.map.infoWindowDoms,i=0;a1=a1||function(){};if(aU.titleDiv.style.display!="none"){i=24}var aV=7,a0=20;if(l.Platform.iphone||l.Platform.android){aV=-1;a0=25}if(this.isWinMax){aZ=aT._config.maxWidth;setTimeout(function(){var a3=i+aU.maxContentDiv.scrollHeight;a3=a3>aT.map.height?aT.map.height-60:a3;aZ=aZ<220?220:aZ;aZ=aZ>600?600:aZ;a3=a3<55?55:a3;a3=a3>440?440:a3;aT._setWinSize(aZ+32,a3+32);aU.contentMain.style.width=aZ+"px";aU.contentMain.style.height=a3+"px";aU.closeButton.style.left=aZ+aV+"px";aU.maxButton.style.left=aZ-a0+aV+"px";aU.contentMain.style.overflow="hidden";aT.dispatchEvent(new aw("onresize"));a1()},aW)}else{var a2=aU.contentDiv.style,aY=aU.titleDiv.style,e=aU.contentMain.style;a2.width=e.width=aY.width="auto";a2.height=e.height=aY.height="auto";a2.whiteSpace="nowrap";if(aU.popDom.style.display=="none"){aU.popDom.style.visibility="hidden";aU.shadowDom.style.visibility="hidden";this.show()}var aZ=aU.contentMain.scrollWidth||0;aZ=aT._config.width==0?aZ:aT._config.width;aZ=aZ<220?220:aZ;aZ=aZ>600?600:aZ;e.width=aZ+"px";h=aU.contentMain.scrollHeight||0;h=aT._config.height==0?h:aT._config.height;aT._setWinSize(aZ+32,h+32);setTimeout(function(){a2.whiteSpace="";if(aT._config.width==0){e.overflowX="hidden"}else{e.overflowX="auto"}if(aT._config.height==0){e.overflowY="hidden"}else{e.overflowY="auto"}h=aU.contentMain.scrollHeight||0;h=aT._config.height==0?h:aT._config.height;h=h<55?55:h;h=h>440?440:h;aT._setWinSize(aZ+32,h+32);aU.popDom.style.visibility="";aU.shadowDom.style.visibility="";e.height=h+"px";aU.closeButton.style.left=aZ+aV+"px";aU.maxButton.style.left=aZ-a0+aV+"px";aT.dispatchEvent(new aw("onresize"));a1()},aW)}},setPosition:function(){if(!this._isMyDom()){return}var e=this.map.infoWindowDoms,i=this.overlay,aU=this.map.pointToOverlayPixel(i.getPoint()),aT=i.getIcon(),aV=new aK(aU.x-aT.offset.width+aT.infoWindowOffset.width+i.getOffset().width,aU.y-aT.offset.height+aT.infoWindowOffset.height+i.getOffset().height);e.popDom.style.left=this._allPopLeft+aV.x+"px";e.popDom.style.top=this._allPopTop+aV.y+"px";e.shadowDom.style.left=this._allShadowLeft+aV.x+"px";e.shadowDom.style.top=this._allShadowTop+aV.y+"px"},setPanToWithDelay:function(e){var i=this;setTimeout(function(){i.setPanTo()},e||200)},setPanTo:function(){if(!this.overlay||!this.overlay.getPoint()||!this._config.enableAutoPan||!this._isMyDom()){return}var a7=this.map;var aZ=a7.infoWindowDoms;var aT=aZ.popDivs;var a8=aZ.popDom;if(!aT||!a8){return}var aU=parseInt(aT[3].style.width)+2;var a4=parseInt(aT[1].style.height)+parseInt(aT[3].style.height)+parseInt(aT[7].style.height);var a2=parseInt(a8.style.left)+this.map.offsetX;var aW=parseInt(a8.style.top)+this.map.offsetY;var aY=new aK(a2,aW);var aX=new aK(aU+a2,a4+aW);if(this._config.height!=0&&document.all){if(!a7.temp.infoKey){a7.temp.infoKey=-1}var a5=-a7.temp.infoKey;a7.temp.infoKey=-a7.temp.infoKey}var a5=0;var a3=0;var e=10;var i=this._config.margin[0];var aV=this._config.margin[1];var a6=this._config.margin[2];var a0=this._config.margin[3];if(aY.x<a0){a5=-aY.x+a0}if(aY.y<i){a3=-aY.y+i}if(aX.x>a7.width-aV){a5=a7.width-aX.x-aV}if(aX.y>a7.height-a6){a3=a7.height-aX.y-a6}this._loadCollisions();var a1=this._config.collisions;if(aY.x<a1[0][0]&&aY.y<a1[0][1]){if(Math.abs(-aY.x+a1[0][0])<Math.abs(-aY.y+a1[0][1])){a5=-aY.x+a1[0][0]}else{if(a7.height-a1[0][1]-a1[3][1]<a4){a5=-aY.x+a1[0][0]}else{a3=-aY.y+a1[0][1]}}if(a7.width-a1[0][0]-a1[1][0]<aU&&aY.y<a1[1][1]){a3=-aY.y+a1[1][1]}}if(aX.x>a7.width-a1[1][0]&&aY.y<a1[1][1]){if(Math.abs(-aX.x+a7.width-a1[1][0])<Math.abs(-aY.y+a1[1][1])&&a7.width-a1[0][0]-a1[1][0]>=aU){a5=-aX.x+a7.width-a1[1][0]}else{a3=-aY.y+a1[1][1];if(a7.width-a1[0][0]-a1[1][0]<aU&&a7.width-a1[0][0]<aU){a5=-aY.x+a1[0][0]}}}if(aY.x<a1[3][0]&&aX.y>a7.height-a1[3][1]){if(Math.abs(-aY.x+a1[3][0])<Math.abs(-aX.y+a7.height-a1[3][1])&&(Math.abs(-aY.x+a1[3][0])<Math.abs(a3)&&a3!=0||a3==0)&&a7.width-a1[3][0]>=aU){a5=-aY.x+a1[3][0]}else{a3=-aX.y+a7.height-a1[3][1]}if(a7.height-a1[0][1]-a1[3][1]<a4&&aY.x<a1[0][0]){a5=-aY.x+a1[0][0]}}if(aX.x>a7.width-a1[2][0]&&aX.y>a7.height-a1[2][1]){if(Math.abs(-aX.x+a7.width-a1[2][0])<Math.abs(-aX.y+a7.height-a1[2][1])&&(Math.abs(-aX.x+a7.width-a1[2][0])<Math.abs(a3)&&a3!=0||a3==0)&&a7.width-a1[0][0]-a1[1][0]>=aU){a5=-aX.x+a7.width-a1[2][0]}else{if(a7.height-a1[1][1]-a1[2][1]>=a4){a3=-aX.y+a7.height-a1[2][1]}else{a3=-aY.y+a1[1][1]}if(a7.width-a1[0][0]-a1[2][0]<aU){a5=-aY.x+a1[0][0]}}}if(a5!=0||a3!=0){a7.panBy(a5,a3)}},_loadCollisions:function(){if(!this.map){return}var aT=this.map;this._config.collisions=[[10,10],[10,10],[10,10],[10,10]];var a2=this.map.container;for(var a0=0,aU=a2.children.length;a0<aU;a0++){var aX,a3,a6=!!(typeof a2.children[a0]._anchor!="undefined"&&a2.children[a0]._offset);if(a2.children[a0]._jsobj&&a2.children[a0]._jsobj instanceof P&&a2.children[a0]._jsobj.blockInfoWindow==true){aX=a2.children[a0]}else{if(a6){aX=a2.children[a0]}else{continue}}var a4=aX.offsetWidth,a1=aX.offsetHeight,e=aX._jsobj,aW,aZ;if(!e||a6){if(typeof aX._anchor!="undefined"&&aX._offset&&an(aX).display!="none"&&an(aX).visibility!="hidden"){aW=aX._offset;aZ=aX._anchor}else{continue}}else{if(e.isVisible()==false){continue}aW=e.getOffset();aZ=e.getAnchor()}switch(aZ){case BMAP_ANCHOR_TOP_LEFT:a3=0;break;case BMAP_ANCHOR_TOP_RIGHT:a3=1;break;case BMAP_ANCHOR_BOTTOM_LEFT:a3=3;break;case BMAP_ANCHOR_BOTTOM_RIGHT:a3=2;break;default:break}var aY=a4+aW.width+10,aV=a1+aW.height+10,a5=this._config.collisions[a3];this._config.collisions[a3]=[aY>a5[0]?aY:a5[0],aV>a5[1]?aV:a5[1]]}},enableMaximize:function(){this._config.enableMaximize=true;if(this._isMyDom()){this.map.infoWindowDoms.maxButton.style.display="block"}},disableMaximize:function(){this._config.enableMaximize=false;if(this._isMyDom()){this.map.infoWindowDoms.maxButton.style.display="none"}},show:function(){if(!this._isMyDom()){return}var i=this.map.infoWindowDoms;if(i.popDom.style.display!="none"){return}l.show(i.popDom);l.show(i.shadowDom);var e=new aw("onopen");e.point=this.getPoint();this.dispatchEvent(e);this.redraw()},hide:function(){if(!this._isMyDom()){return false}var i=this.map.infoWindowDoms;if(i.popDom.style.display=="none"){return false}if(this._config.onClosing()==false){return false}l.hide(i.popDom);l.hide(i.shadowDom);if(this.isWinMax){this.isWinMax=false;i.maxContentDiv.style.display="none";i.contentDiv.style.display="";i.maxButton.src=this.IMG_PATH+"iw_plus.gif"}var e=new aw("onclose");e.point=this.getPoint();this.dispatchEvent(e);if(this.map.temp._clickCloseBindTimer){clearTimeout(this.map.temp._clickCloseBindTimer);this.map.temp._clickCloseBindTimer=null}else{this.map.removeEventListener("click",this.map.temp._clickCloseHandler);this.map.temp._clickCloseBinded=false}this.decontrol();return true},maximize:function(){if(!this.map||!this.isOpen()||!this._config.enableMaximize||this.isWinMax){return}if(!this._isMyDom()){return}var i=this.map.infoWindowDoms.maxButton;var e=this;e.isWinMax=true;i.src=e.IMG_PATH+"iw_minus.gif";e.setMaxContent();e.map.infoWindowDoms.maxContentDiv.style.display="block";e.redraw();e.dispatchEvent(new aw("onmaximize"));e.setPanToWithDelay()},restore:function(){if(!this.map||!this.isOpen()||!this.isWinMax){return}if(!this._isMyDom()){return}this.isWinMax=false;var e=this;var i=e.map.infoWindowDoms.maxButton;i.src=e.IMG_PATH+"iw_plus.gif";e.setContent();e.map.infoWindowDoms.maxContentDiv.style.display="none";e.redraw();e.dispatchEvent(new aw("onrestore"));e.setPanToWithDelay()},_revert:function(){if(!this._isMyDom()){return}this.isWinMax=false;var e=this.map.infoWindowDoms;e.titleDiv.innerHTML="";e.contentDiv.innerHTML="";e.maxContentDiv.innerHTML="";e.maxButton.src=this.IMG_PATH+"iw_plus.gif"},_setOverflow:function(){var aT=this.map;if(!this._isMyDom()){return}var i=aT.infoWindowDoms,e=i.contentMain.style;i._overflowX=e.overflowX;i._overflowY=e.overflowY;e.overflowX="hidden";e.overflowY="hidden"},_resetOverflow:function(){var aT=this.map;if(!this._isMyDom()||!aT.infoWindowDoms._overflowX||!aT.infoWindowDoms._overflowY){return}var i=aT.infoWindowDoms,e=i.contentMain.style;e.overflowX=i._overflowX;e.overflowY=i._overflowY;delete i._overflowX;delete i._overflowY},isOpen:function(){if(!this.map){return false}var e=this.map.temp.infoWin;if(!e){return false}if(!this._isMyDom()){return false}if(e&&e.overlay===this.overlay&&this.map.infoWindowDoms&&this.map.infoWindowDoms.popDom.style.display=="none"){return false}else{return true}},setMaxScene:function(i){var aT=this;if(!this._isMyDom()){return}var e=aT.map.infoWindowDoms;e.maxButton.style.display="block";var aU=e.maxButton;if(!!i==!!this.isWinMax){return}if(i){aT.isWinMax=true;aU.src=aT.IMG_PATH+"iw_minus.gif";aT.setMaxContent();e.maxContentDiv.style.display="block"}else{aT.isWinMax=false;aU.src=aT.IMG_PATH+"iw_plus.gif";aT.setContent();e.maxContentDiv.style.display="none"}this.redraw()},_draw:function(){if(this._visible==true&&this.overlay){this.overlay.openInfoWindow(this)}},_isMyDom:function(){return(this.map&&this.map.infoWindowDoms&&this.map.infoWindowDoms.hashCode==this.hashCode)}});aF.prototype.openInfoWindow=function(aU){var aT=this.map;if(!aU||!this.map||!this.domElement||this.isVisible()==false||aU.toString()!="InfoWindow"){return}var i=aT.temp;if(i.infoWin&&i.infoWin.overlay&&i.infoWin.overlay._fromMap){aT.closeInfoWindow()}if(i.infoWin===aU&&i.infoWin.isOpen()&&i.infoWin.overlay===this){aU.setPanToWithDelay();return}aT.closeInfoWindow();this.infoWindow=aU;if(i.infoWin==null||i.infoWin!=aU){if(aT.infoWindowDoms){aT.infoWindowDoms.closeButton.onclick=null;aT.infoWindowDoms.maxButton.onclick=null}i.infoWin=aU;aU.initialize(this)}else{aU.redraw(null,true)}l.BaseClass.call(aU,aU.hashCode);if(!i._clickCloseHandler){i._clickCloseHandler=function(aV){if(!aV.overlay){if(aT.temp.infoWin&&aT.temp.infoWin._config.enableCloseOnClick){aT.closeInfoWindow();aT.removeEventListener("click",arguments.callee);i._clickCloseBinded=false}}}}if(!i._clickCloseBinded){i._clickCloseBindTimer=setTimeout(function(){aT.addEventListener("click",i._clickCloseHandler);i._clickCloseBinded=true;i._clickCloseBindTimer=null},200)}if(i._infoWin){delete i._infoWin}aU.overlay=this;var e=aT.infoWindowDoms;this.map.getPanes().floatPane.appendChild(e.popDom);this.map.getPanes().floatShadow.appendChild(e.shadowDom);aU.setPanToWithDelay();this.dispatchEvent(new aw("oninfowindowopen"))};aF.prototype.closeInfoWindow=function(){if(!this.map||!this.map.infoWindowDoms){return}var i=this;if(i.infoWindow&&i.infoWindow.hashCode==i.map.infoWindowDoms.hashCode){try{if(i.infoWindow.hide()==true){i.dispatchEvent(new aw("oninfowindowclose"));i.map.temp.infoWin=i.infoWindow=null}}catch(e){}}};');
