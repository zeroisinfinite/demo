/*
 * @name: cipher.js
 * @description: 
 * @author: wondger@gmail.com
 * @date: 2014-01-03
 * @param: 
 * @todo: 
 * @changelog: 
 */
var crypto = require("crypto");

module.exports = exports = {
    encrypt: function(value, secret) {
        if ('string' != typeof value) throw new TypeError('value required');
        if ('string' != typeof secret) throw new TypeError('secret required');

        var cipher = crypto.createCipher("des", secret);
        var ret = cipher.update(value, "utf8", "hex");
        ret += cipher.final("hex");

        return ret;
    },
    decrypt: function(value, secret) {
        if ('string' != typeof value) throw new TypeError('value required');
        if ('string' != typeof secret) throw new TypeError('secret required');

        var decipher,
            ret;

        try {
            decipher = crypto.createDecipher('des', secret);  
            ret = decipher.update(value,'hex','utf8');  
            ret += decipher.final('utf8');  
        }
        catch (e) {
            ret = "";
        }

        return ret;
    }
};
